import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{$ as t,A as n,At as r,B as i,Bt as a,C as o,Ct as s,D as c,Dt as l,E as u,Et as d,F as f,Ft as p,G as m,Gt as h,H as g,Ht as _,I as v,It as y,J as b,Jt as ee,K as x,Kt as S,L as C,Lt as w,M as te,Mt as T,N as E,Nt as ne,O as re,Ot as D,P as O,Pt as k,Q as A,Qt as ie,R as ae,Rt as oe,S as se,St as j,T as M,Tt as ce,U as le,Ut as N,V as ue,Vt as de,W as fe,Wt as pe,X as me,Xt as he,Y as ge,Yt as _e,Z as ve,Zt as ye,_ as be,_t as xe,a as Se,at as Ce,b as we,bt as Te,c as Ee,ct as De,d as Oe,dt as ke,et as Ae,f as je,ft as Me,g as Ne,gt as Pe,h as Fe,ht as Ie,i as Le,it as Re,j as ze,jt as Be,k as Ve,kt as He,l as Ue,lt as We,m as Ge,mt as Ke,n as qe,nt as Je,o as Ye,ot as Xe,p as Ze,pt as Qe,q as $e,qt as et,r as tt,rt as nt,s as rt,st as it,t as at,tt as ot,u as st,ut as ct,v as lt,vt as ut,w as dt,wt as ft,x as pt,xt as mt,y as ht,yt as gt,z as _t,zt as vt}from"./react-vendor-DCEPkS4E.js";import"./radix-ui-DamdIxrY.js";import{t as yt}from"./utils-D9UH86wd.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var bt=ye(),P=e(ie(),1),xt=(e,t)=>{let n=Array(e.length+t.length);for(let t=0;t<e.length;t++)n[t]=e[t];for(let r=0;r<t.length;r++)n[e.length+r]=t[r];return n},St=(e,t)=>({classGroupId:e,validator:t}),Ct=(e=new Map,t=null,n)=>({nextPart:e,validators:t,classGroupId:n}),wt=`-`,Tt=[],Et=`arbitrary..`,Dt=e=>{let t=At(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{if(e.startsWith(`[`)&&e.endsWith(`]`))return kt(e);let n=e.split(wt);return Ot(n,n[0]===``&&n.length>1?1:0,t)},getConflictingClassGroupIds:(e,t)=>{if(t){let t=r[e],i=n[e];return t?i?xt(i,t):t:i||Tt}return n[e]||Tt}}},Ot=(e,t,n)=>{if(e.length-t===0)return n.classGroupId;let r=e[t],i=n.nextPart.get(r);if(i){let n=Ot(e,t+1,i);if(n)return n}let a=n.validators;if(a===null)return;let o=t===0?e.join(wt):e.slice(t).join(wt),s=a.length;for(let e=0;e<s;e++){let t=a[e];if(t.validator(o))return t.classGroupId}},kt=e=>e.slice(1,-1).indexOf(`:`)===-1?void 0:(()=>{let t=e.slice(1,-1),n=t.indexOf(`:`),r=t.slice(0,n);return r?Et+r:void 0})(),At=e=>{let{theme:t,classGroups:n}=e;return jt(n,t)},jt=(e,t)=>{let n=Ct();for(let r in e){let i=e[r];Mt(i,n,r,t)}return n},Mt=(e,t,n,r)=>{let i=e.length;for(let a=0;a<i;a++){let i=e[a];Nt(i,t,n,r)}},Nt=(e,t,n,r)=>{if(typeof e==`string`){Pt(e,t,n);return}if(typeof e==`function`){Ft(e,t,n,r);return}It(e,t,n,r)},Pt=(e,t,n)=>{let r=e===``?t:Lt(t,e);r.classGroupId=n},Ft=(e,t,n,r)=>{if(Rt(e)){Mt(e(r),t,n,r);return}t.validators===null&&(t.validators=[]),t.validators.push(St(n,e))},It=(e,t,n,r)=>{let i=Object.entries(e),a=i.length;for(let e=0;e<a;e++){let[a,o]=i[e];Mt(o,Lt(t,a),n,r)}},Lt=(e,t)=>{let n=e,r=t.split(wt),i=r.length;for(let e=0;e<i;e++){let t=r[e],i=n.nextPart.get(t);i||(i=Ct(),n.nextPart.set(t,i)),n=i}return n},Rt=e=>`isThemeGetter`in e&&e.isThemeGetter===!0,zt=e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,n=Object.create(null),r=Object.create(null),i=(i,a)=>{n[i]=a,t++,t>e&&(t=0,r=n,n=Object.create(null))};return{get(e){let t=n[e];if(t!==void 0)return t;if((t=r[e])!==void 0)return i(e,t),t},set(e,t){e in n?n[e]=t:i(e,t)}}},Bt=`!`,Vt=`:`,Ht=[],Ut=(e,t,n,r,i)=>({modifiers:e,hasImportantModifier:t,baseClassName:n,maybePostfixModifierPosition:r,isExternal:i}),Wt=e=>{let{prefix:t,experimentalParseClassName:n}=e,r=e=>{let t=[],n=0,r=0,i=0,a,o=e.length;for(let s=0;s<o;s++){let o=e[s];if(n===0&&r===0){if(o===Vt){t.push(e.slice(i,s)),i=s+1;continue}if(o===`/`){a=s;continue}}o===`[`?n++:o===`]`?n--:o===`(`?r++:o===`)`&&r--}let s=t.length===0?e:e.slice(i),c=s,l=!1;s.endsWith(Bt)?(c=s.slice(0,-1),l=!0):s.startsWith(Bt)&&(c=s.slice(1),l=!0);let u=a&&a>i?a-i:void 0;return Ut(t,l,c,u)};if(t){let e=t+Vt,n=r;r=t=>t.startsWith(e)?n(t.slice(e.length)):Ut(Ht,!1,t,void 0,!0)}if(n){let e=r;r=t=>n({className:t,parseClassName:e})}return r},Gt=e=>{let t=new Map;return e.orderSensitiveModifiers.forEach((e,n)=>{t.set(e,1e6+n)}),e=>{let n=[],r=[];for(let i=0;i<e.length;i++){let a=e[i],o=a[0]===`[`,s=t.has(a);o||s?(r.length>0&&(r.sort(),n.push(...r),r=[]),n.push(a)):r.push(a)}return r.length>0&&(r.sort(),n.push(...r)),n}},Kt=e=>({cache:zt(e.cacheSize),parseClassName:Wt(e),sortModifiers:Gt(e),...Dt(e)}),qt=/\s+/,Jt=(e,t)=>{let{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:a}=t,o=[],s=e.trim().split(qt),c=``;for(let e=s.length-1;e>=0;--e){let t=s[e],{isExternal:l,modifiers:u,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:p}=n(t);if(l){c=t+(c.length>0?` `+c:c);continue}let m=!!p,h=r(m?f.substring(0,p):f);if(!h){if(!m){c=t+(c.length>0?` `+c:c);continue}if(h=r(f),!h){c=t+(c.length>0?` `+c:c);continue}m=!1}let g=u.length===0?``:u.length===1?u[0]:a(u).join(`:`),_=d?g+Bt:g,v=_+h;if(o.indexOf(v)>-1)continue;o.push(v);let y=i(h,m);for(let e=0;e<y.length;++e){let t=y[e];o.push(_+t)}c=t+(c.length>0?` `+c:c)}return c},Yt=(...e)=>{let t=0,n,r,i=``;for(;t<e.length;)(n=e[t++])&&(r=Xt(n))&&(i&&(i+=` `),i+=r);return i},Xt=e=>{if(typeof e==`string`)return e;let t,n=``;for(let r=0;r<e.length;r++)e[r]&&(t=Xt(e[r]))&&(n&&(n+=` `),n+=t);return n},Zt=(e,...t)=>{let n,r,i,a,o=o=>(n=Kt(t.reduce((e,t)=>t(e),e())),r=n.cache.get,i=n.cache.set,a=s,s(o)),s=e=>{let t=r(e);if(t)return t;let a=Jt(e,n);return i(e,a),a};return a=o,(...e)=>a(Yt(...e))},Qt=[],F=e=>{let t=t=>t[e]||Qt;return t.isThemeGetter=!0,t},$t=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,en=/^\((?:(\w[\w-]*):)?(.+)\)$/i,tn=/^\d+\/\d+$/,nn=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,rn=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,an=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,on=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,sn=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,cn=e=>tn.test(e),I=e=>!!e&&!Number.isNaN(Number(e)),L=e=>!!e&&Number.isInteger(Number(e)),ln=e=>e.endsWith(`%`)&&I(e.slice(0,-1)),R=e=>nn.test(e),un=()=>!0,dn=e=>rn.test(e)&&!an.test(e),fn=()=>!1,pn=e=>on.test(e),mn=e=>sn.test(e),hn=e=>!z(e)&&!B(e),gn=e=>On(e,Mn,fn),z=e=>$t.test(e),_n=e=>On(e,Nn,dn),vn=e=>On(e,Pn,I),yn=e=>On(e,An,fn),bn=e=>On(e,jn,mn),xn=e=>On(e,In,pn),B=e=>en.test(e),Sn=e=>kn(e,Nn),Cn=e=>kn(e,Fn),wn=e=>kn(e,An),Tn=e=>kn(e,Mn),En=e=>kn(e,jn),Dn=e=>kn(e,In,!0),On=(e,t,n)=>{let r=$t.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},kn=(e,t,n=!1)=>{let r=en.exec(e);return r?r[1]?t(r[1]):n:!1},An=e=>e===`position`||e===`percentage`,jn=e=>e===`image`||e===`url`,Mn=e=>e===`length`||e===`size`||e===`bg-size`,Nn=e=>e===`length`,Pn=e=>e===`number`,Fn=e=>e===`family-name`,In=e=>e===`shadow`,Ln=Zt(()=>{let e=F(`color`),t=F(`font`),n=F(`text`),r=F(`font-weight`),i=F(`tracking`),a=F(`leading`),o=F(`breakpoint`),s=F(`container`),c=F(`spacing`),l=F(`radius`),u=F(`shadow`),d=F(`inset-shadow`),f=F(`text-shadow`),p=F(`drop-shadow`),m=F(`blur`),h=F(`perspective`),g=F(`aspect`),_=F(`ease`),v=F(`animate`),y=()=>[`auto`,`avoid`,`all`,`avoid-page`,`page`,`left`,`right`,`column`],b=()=>[`center`,`top`,`bottom`,`left`,`right`,`top-left`,`left-top`,`top-right`,`right-top`,`bottom-right`,`right-bottom`,`bottom-left`,`left-bottom`],ee=()=>[...b(),B,z],x=()=>[`auto`,`hidden`,`clip`,`visible`,`scroll`],S=()=>[`auto`,`contain`,`none`],C=()=>[B,z,c],w=()=>[cn,`full`,`auto`,...C()],te=()=>[L,`none`,`subgrid`,B,z],T=()=>[`auto`,{span:[`full`,L,B,z]},L,B,z],E=()=>[L,`auto`,B,z],ne=()=>[`auto`,`min`,`max`,`fr`,B,z],re=()=>[`start`,`end`,`center`,`between`,`around`,`evenly`,`stretch`,`baseline`,`center-safe`,`end-safe`],D=()=>[`start`,`end`,`center`,`stretch`,`center-safe`,`end-safe`],O=()=>[`auto`,...C()],k=()=>[cn,`auto`,`full`,`dvw`,`dvh`,`lvw`,`lvh`,`svw`,`svh`,`min`,`max`,`fit`,...C()],A=()=>[e,B,z],ie=()=>[...b(),wn,yn,{position:[B,z]}],ae=()=>[`no-repeat`,{repeat:[``,`x`,`y`,`space`,`round`]}],oe=()=>[`auto`,`cover`,`contain`,Tn,gn,{size:[B,z]}],se=()=>[ln,Sn,_n],j=()=>[``,`none`,`full`,l,B,z],M=()=>[``,I,Sn,_n],ce=()=>[`solid`,`dashed`,`dotted`,`double`],le=()=>[`normal`,`multiply`,`screen`,`overlay`,`darken`,`lighten`,`color-dodge`,`color-burn`,`hard-light`,`soft-light`,`difference`,`exclusion`,`hue`,`saturation`,`color`,`luminosity`],N=()=>[I,ln,wn,yn],ue=()=>[``,`none`,m,B,z],de=()=>[`none`,I,B,z],fe=()=>[`none`,I,B,z],pe=()=>[I,B,z],me=()=>[cn,`full`,...C()];return{cacheSize:500,theme:{animate:[`spin`,`ping`,`pulse`,`bounce`],aspect:[`video`],blur:[R],breakpoint:[R],color:[un],container:[R],"drop-shadow":[R],ease:[`in`,`out`,`in-out`],font:[hn],"font-weight":[`thin`,`extralight`,`light`,`normal`,`medium`,`semibold`,`bold`,`extrabold`,`black`],"inset-shadow":[R],leading:[`none`,`tight`,`snug`,`normal`,`relaxed`,`loose`],perspective:[`dramatic`,`near`,`normal`,`midrange`,`distant`,`none`],radius:[R],shadow:[R],spacing:[`px`,I],text:[R],"text-shadow":[R],tracking:[`tighter`,`tight`,`normal`,`wide`,`wider`,`widest`]},classGroups:{aspect:[{aspect:[`auto`,`square`,cn,z,B,g]}],container:[`container`],columns:[{columns:[I,z,B,s]}],"break-after":[{"break-after":y()}],"break-before":[{"break-before":y()}],"break-inside":[{"break-inside":[`auto`,`avoid`,`avoid-page`,`avoid-column`]}],"box-decoration":[{"box-decoration":[`slice`,`clone`]}],box:[{box:[`border`,`content`]}],display:[`block`,`inline-block`,`inline`,`flex`,`inline-flex`,`table`,`inline-table`,`table-caption`,`table-cell`,`table-column`,`table-column-group`,`table-footer-group`,`table-header-group`,`table-row-group`,`table-row`,`flow-root`,`grid`,`inline-grid`,`contents`,`list-item`,`hidden`],sr:[`sr-only`,`not-sr-only`],float:[{float:[`right`,`left`,`none`,`start`,`end`]}],clear:[{clear:[`left`,`right`,`both`,`none`,`start`,`end`]}],isolation:[`isolate`,`isolation-auto`],"object-fit":[{object:[`contain`,`cover`,`fill`,`none`,`scale-down`]}],"object-position":[{object:ee()}],overflow:[{overflow:x()}],"overflow-x":[{"overflow-x":x()}],"overflow-y":[{"overflow-y":x()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:[`static`,`fixed`,`absolute`,`relative`,`sticky`],inset:[{inset:w()}],"inset-x":[{"inset-x":w()}],"inset-y":[{"inset-y":w()}],start:[{start:w()}],end:[{end:w()}],top:[{top:w()}],right:[{right:w()}],bottom:[{bottom:w()}],left:[{left:w()}],visibility:[`visible`,`invisible`,`collapse`],z:[{z:[L,`auto`,B,z]}],basis:[{basis:[cn,`full`,`auto`,s,...C()]}],"flex-direction":[{flex:[`row`,`row-reverse`,`col`,`col-reverse`]}],"flex-wrap":[{flex:[`nowrap`,`wrap`,`wrap-reverse`]}],flex:[{flex:[I,cn,`auto`,`initial`,`none`,z]}],grow:[{grow:[``,I,B,z]}],shrink:[{shrink:[``,I,B,z]}],order:[{order:[L,`first`,`last`,`none`,B,z]}],"grid-cols":[{"grid-cols":te()}],"col-start-end":[{col:T()}],"col-start":[{"col-start":E()}],"col-end":[{"col-end":E()}],"grid-rows":[{"grid-rows":te()}],"row-start-end":[{row:T()}],"row-start":[{"row-start":E()}],"row-end":[{"row-end":E()}],"grid-flow":[{"grid-flow":[`row`,`col`,`dense`,`row-dense`,`col-dense`]}],"auto-cols":[{"auto-cols":ne()}],"auto-rows":[{"auto-rows":ne()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...re(),`normal`]}],"justify-items":[{"justify-items":[...D(),`normal`]}],"justify-self":[{"justify-self":[`auto`,...D()]}],"align-content":[{content:[`normal`,...re()]}],"align-items":[{items:[...D(),{baseline:[``,`last`]}]}],"align-self":[{self:[`auto`,...D(),{baseline:[``,`last`]}]}],"place-content":[{"place-content":re()}],"place-items":[{"place-items":[...D(),`baseline`]}],"place-self":[{"place-self":[`auto`,...D()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:O()}],mx:[{mx:O()}],my:[{my:O()}],ms:[{ms:O()}],me:[{me:O()}],mt:[{mt:O()}],mr:[{mr:O()}],mb:[{mb:O()}],ml:[{ml:O()}],"space-x":[{"space-x":C()}],"space-x-reverse":[`space-x-reverse`],"space-y":[{"space-y":C()}],"space-y-reverse":[`space-y-reverse`],size:[{size:k()}],w:[{w:[s,`screen`,...k()]}],"min-w":[{"min-w":[s,`screen`,`none`,...k()]}],"max-w":[{"max-w":[s,`screen`,`none`,`prose`,{screen:[o]},...k()]}],h:[{h:[`screen`,`lh`,...k()]}],"min-h":[{"min-h":[`screen`,`lh`,`none`,...k()]}],"max-h":[{"max-h":[`screen`,`lh`,...k()]}],"font-size":[{text:[`base`,n,Sn,_n]}],"font-smoothing":[`antialiased`,`subpixel-antialiased`],"font-style":[`italic`,`not-italic`],"font-weight":[{font:[r,B,vn]}],"font-stretch":[{"font-stretch":[`ultra-condensed`,`extra-condensed`,`condensed`,`semi-condensed`,`normal`,`semi-expanded`,`expanded`,`extra-expanded`,`ultra-expanded`,ln,z]}],"font-family":[{font:[Cn,z,t]}],"fvn-normal":[`normal-nums`],"fvn-ordinal":[`ordinal`],"fvn-slashed-zero":[`slashed-zero`],"fvn-figure":[`lining-nums`,`oldstyle-nums`],"fvn-spacing":[`proportional-nums`,`tabular-nums`],"fvn-fraction":[`diagonal-fractions`,`stacked-fractions`],tracking:[{tracking:[i,B,z]}],"line-clamp":[{"line-clamp":[I,`none`,B,vn]}],leading:[{leading:[a,...C()]}],"list-image":[{"list-image":[`none`,B,z]}],"list-style-position":[{list:[`inside`,`outside`]}],"list-style-type":[{list:[`disc`,`decimal`,`none`,B,z]}],"text-alignment":[{text:[`left`,`center`,`right`,`justify`,`start`,`end`]}],"placeholder-color":[{placeholder:A()}],"text-color":[{text:A()}],"text-decoration":[`underline`,`overline`,`line-through`,`no-underline`],"text-decoration-style":[{decoration:[...ce(),`wavy`]}],"text-decoration-thickness":[{decoration:[I,`from-font`,`auto`,B,_n]}],"text-decoration-color":[{decoration:A()}],"underline-offset":[{"underline-offset":[I,`auto`,B,z]}],"text-transform":[`uppercase`,`lowercase`,`capitalize`,`normal-case`],"text-overflow":[`truncate`,`text-ellipsis`,`text-clip`],"text-wrap":[{text:[`wrap`,`nowrap`,`balance`,`pretty`]}],indent:[{indent:C()}],"vertical-align":[{align:[`baseline`,`top`,`middle`,`bottom`,`text-top`,`text-bottom`,`sub`,`super`,B,z]}],whitespace:[{whitespace:[`normal`,`nowrap`,`pre`,`pre-line`,`pre-wrap`,`break-spaces`]}],break:[{break:[`normal`,`words`,`all`,`keep`]}],wrap:[{wrap:[`break-word`,`anywhere`,`normal`]}],hyphens:[{hyphens:[`none`,`manual`,`auto`]}],content:[{content:[`none`,B,z]}],"bg-attachment":[{bg:[`fixed`,`local`,`scroll`]}],"bg-clip":[{"bg-clip":[`border`,`padding`,`content`,`text`]}],"bg-origin":[{"bg-origin":[`border`,`padding`,`content`]}],"bg-position":[{bg:ie()}],"bg-repeat":[{bg:ae()}],"bg-size":[{bg:oe()}],"bg-image":[{bg:[`none`,{linear:[{to:[`t`,`tr`,`r`,`br`,`b`,`bl`,`l`,`tl`]},L,B,z],radial:[``,B,z],conic:[L,B,z]},En,bn]}],"bg-color":[{bg:A()}],"gradient-from-pos":[{from:se()}],"gradient-via-pos":[{via:se()}],"gradient-to-pos":[{to:se()}],"gradient-from":[{from:A()}],"gradient-via":[{via:A()}],"gradient-to":[{to:A()}],rounded:[{rounded:j()}],"rounded-s":[{"rounded-s":j()}],"rounded-e":[{"rounded-e":j()}],"rounded-t":[{"rounded-t":j()}],"rounded-r":[{"rounded-r":j()}],"rounded-b":[{"rounded-b":j()}],"rounded-l":[{"rounded-l":j()}],"rounded-ss":[{"rounded-ss":j()}],"rounded-se":[{"rounded-se":j()}],"rounded-ee":[{"rounded-ee":j()}],"rounded-es":[{"rounded-es":j()}],"rounded-tl":[{"rounded-tl":j()}],"rounded-tr":[{"rounded-tr":j()}],"rounded-br":[{"rounded-br":j()}],"rounded-bl":[{"rounded-bl":j()}],"border-w":[{border:M()}],"border-w-x":[{"border-x":M()}],"border-w-y":[{"border-y":M()}],"border-w-s":[{"border-s":M()}],"border-w-e":[{"border-e":M()}],"border-w-t":[{"border-t":M()}],"border-w-r":[{"border-r":M()}],"border-w-b":[{"border-b":M()}],"border-w-l":[{"border-l":M()}],"divide-x":[{"divide-x":M()}],"divide-x-reverse":[`divide-x-reverse`],"divide-y":[{"divide-y":M()}],"divide-y-reverse":[`divide-y-reverse`],"border-style":[{border:[...ce(),`hidden`,`none`]}],"divide-style":[{divide:[...ce(),`hidden`,`none`]}],"border-color":[{border:A()}],"border-color-x":[{"border-x":A()}],"border-color-y":[{"border-y":A()}],"border-color-s":[{"border-s":A()}],"border-color-e":[{"border-e":A()}],"border-color-t":[{"border-t":A()}],"border-color-r":[{"border-r":A()}],"border-color-b":[{"border-b":A()}],"border-color-l":[{"border-l":A()}],"divide-color":[{divide:A()}],"outline-style":[{outline:[...ce(),`none`,`hidden`]}],"outline-offset":[{"outline-offset":[I,B,z]}],"outline-w":[{outline:[``,I,Sn,_n]}],"outline-color":[{outline:A()}],shadow:[{shadow:[``,`none`,u,Dn,xn]}],"shadow-color":[{shadow:A()}],"inset-shadow":[{"inset-shadow":[`none`,d,Dn,xn]}],"inset-shadow-color":[{"inset-shadow":A()}],"ring-w":[{ring:M()}],"ring-w-inset":[`ring-inset`],"ring-color":[{ring:A()}],"ring-offset-w":[{"ring-offset":[I,_n]}],"ring-offset-color":[{"ring-offset":A()}],"inset-ring-w":[{"inset-ring":M()}],"inset-ring-color":[{"inset-ring":A()}],"text-shadow":[{"text-shadow":[`none`,f,Dn,xn]}],"text-shadow-color":[{"text-shadow":A()}],opacity:[{opacity:[I,B,z]}],"mix-blend":[{"mix-blend":[...le(),`plus-darker`,`plus-lighter`]}],"bg-blend":[{"bg-blend":le()}],"mask-clip":[{"mask-clip":[`border`,`padding`,`content`,`fill`,`stroke`,`view`]},`mask-no-clip`],"mask-composite":[{mask:[`add`,`subtract`,`intersect`,`exclude`]}],"mask-image-linear-pos":[{"mask-linear":[I]}],"mask-image-linear-from-pos":[{"mask-linear-from":N()}],"mask-image-linear-to-pos":[{"mask-linear-to":N()}],"mask-image-linear-from-color":[{"mask-linear-from":A()}],"mask-image-linear-to-color":[{"mask-linear-to":A()}],"mask-image-t-from-pos":[{"mask-t-from":N()}],"mask-image-t-to-pos":[{"mask-t-to":N()}],"mask-image-t-from-color":[{"mask-t-from":A()}],"mask-image-t-to-color":[{"mask-t-to":A()}],"mask-image-r-from-pos":[{"mask-r-from":N()}],"mask-image-r-to-pos":[{"mask-r-to":N()}],"mask-image-r-from-color":[{"mask-r-from":A()}],"mask-image-r-to-color":[{"mask-r-to":A()}],"mask-image-b-from-pos":[{"mask-b-from":N()}],"mask-image-b-to-pos":[{"mask-b-to":N()}],"mask-image-b-from-color":[{"mask-b-from":A()}],"mask-image-b-to-color":[{"mask-b-to":A()}],"mask-image-l-from-pos":[{"mask-l-from":N()}],"mask-image-l-to-pos":[{"mask-l-to":N()}],"mask-image-l-from-color":[{"mask-l-from":A()}],"mask-image-l-to-color":[{"mask-l-to":A()}],"mask-image-x-from-pos":[{"mask-x-from":N()}],"mask-image-x-to-pos":[{"mask-x-to":N()}],"mask-image-x-from-color":[{"mask-x-from":A()}],"mask-image-x-to-color":[{"mask-x-to":A()}],"mask-image-y-from-pos":[{"mask-y-from":N()}],"mask-image-y-to-pos":[{"mask-y-to":N()}],"mask-image-y-from-color":[{"mask-y-from":A()}],"mask-image-y-to-color":[{"mask-y-to":A()}],"mask-image-radial":[{"mask-radial":[B,z]}],"mask-image-radial-from-pos":[{"mask-radial-from":N()}],"mask-image-radial-to-pos":[{"mask-radial-to":N()}],"mask-image-radial-from-color":[{"mask-radial-from":A()}],"mask-image-radial-to-color":[{"mask-radial-to":A()}],"mask-image-radial-shape":[{"mask-radial":[`circle`,`ellipse`]}],"mask-image-radial-size":[{"mask-radial":[{closest:[`side`,`corner`],farthest:[`side`,`corner`]}]}],"mask-image-radial-pos":[{"mask-radial-at":b()}],"mask-image-conic-pos":[{"mask-conic":[I]}],"mask-image-conic-from-pos":[{"mask-conic-from":N()}],"mask-image-conic-to-pos":[{"mask-conic-to":N()}],"mask-image-conic-from-color":[{"mask-conic-from":A()}],"mask-image-conic-to-color":[{"mask-conic-to":A()}],"mask-mode":[{mask:[`alpha`,`luminance`,`match`]}],"mask-origin":[{"mask-origin":[`border`,`padding`,`content`,`fill`,`stroke`,`view`]}],"mask-position":[{mask:ie()}],"mask-repeat":[{mask:ae()}],"mask-size":[{mask:oe()}],"mask-type":[{"mask-type":[`alpha`,`luminance`]}],"mask-image":[{mask:[`none`,B,z]}],filter:[{filter:[``,`none`,B,z]}],blur:[{blur:ue()}],brightness:[{brightness:[I,B,z]}],contrast:[{contrast:[I,B,z]}],"drop-shadow":[{"drop-shadow":[``,`none`,p,Dn,xn]}],"drop-shadow-color":[{"drop-shadow":A()}],grayscale:[{grayscale:[``,I,B,z]}],"hue-rotate":[{"hue-rotate":[I,B,z]}],invert:[{invert:[``,I,B,z]}],saturate:[{saturate:[I,B,z]}],sepia:[{sepia:[``,I,B,z]}],"backdrop-filter":[{"backdrop-filter":[``,`none`,B,z]}],"backdrop-blur":[{"backdrop-blur":ue()}],"backdrop-brightness":[{"backdrop-brightness":[I,B,z]}],"backdrop-contrast":[{"backdrop-contrast":[I,B,z]}],"backdrop-grayscale":[{"backdrop-grayscale":[``,I,B,z]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[I,B,z]}],"backdrop-invert":[{"backdrop-invert":[``,I,B,z]}],"backdrop-opacity":[{"backdrop-opacity":[I,B,z]}],"backdrop-saturate":[{"backdrop-saturate":[I,B,z]}],"backdrop-sepia":[{"backdrop-sepia":[``,I,B,z]}],"border-collapse":[{border:[`collapse`,`separate`]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:[`auto`,`fixed`]}],caption:[{caption:[`top`,`bottom`]}],transition:[{transition:[``,`all`,`colors`,`opacity`,`shadow`,`transform`,`none`,B,z]}],"transition-behavior":[{transition:[`normal`,`discrete`]}],duration:[{duration:[I,`initial`,B,z]}],ease:[{ease:[`linear`,`initial`,_,B,z]}],delay:[{delay:[I,B,z]}],animate:[{animate:[`none`,v,B,z]}],backface:[{backface:[`hidden`,`visible`]}],perspective:[{perspective:[h,B,z]}],"perspective-origin":[{"perspective-origin":ee()}],rotate:[{rotate:de()}],"rotate-x":[{"rotate-x":de()}],"rotate-y":[{"rotate-y":de()}],"rotate-z":[{"rotate-z":de()}],scale:[{scale:fe()}],"scale-x":[{"scale-x":fe()}],"scale-y":[{"scale-y":fe()}],"scale-z":[{"scale-z":fe()}],"scale-3d":[`scale-3d`],skew:[{skew:pe()}],"skew-x":[{"skew-x":pe()}],"skew-y":[{"skew-y":pe()}],transform:[{transform:[B,z,``,`none`,`gpu`,`cpu`]}],"transform-origin":[{origin:ee()}],"transform-style":[{transform:[`3d`,`flat`]}],translate:[{translate:me()}],"translate-x":[{"translate-x":me()}],"translate-y":[{"translate-y":me()}],"translate-z":[{"translate-z":me()}],"translate-none":[`translate-none`],accent:[{accent:A()}],appearance:[{appearance:[`none`,`auto`]}],"caret-color":[{caret:A()}],"color-scheme":[{scheme:[`normal`,`dark`,`light`,`light-dark`,`only-dark`,`only-light`]}],cursor:[{cursor:[`auto`,`default`,`pointer`,`wait`,`text`,`move`,`help`,`not-allowed`,`none`,`context-menu`,`progress`,`cell`,`crosshair`,`vertical-text`,`alias`,`copy`,`no-drop`,`grab`,`grabbing`,`all-scroll`,`col-resize`,`row-resize`,`n-resize`,`e-resize`,`s-resize`,`w-resize`,`ne-resize`,`nw-resize`,`se-resize`,`sw-resize`,`ew-resize`,`ns-resize`,`nesw-resize`,`nwse-resize`,`zoom-in`,`zoom-out`,B,z]}],"field-sizing":[{"field-sizing":[`fixed`,`content`]}],"pointer-events":[{"pointer-events":[`auto`,`none`]}],resize:[{resize:[`none`,``,`y`,`x`]}],"scroll-behavior":[{scroll:[`auto`,`smooth`]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:[`start`,`end`,`center`,`align-none`]}],"snap-stop":[{snap:[`normal`,`always`]}],"snap-type":[{snap:[`none`,`x`,`y`,`both`]}],"snap-strictness":[{snap:[`mandatory`,`proximity`]}],touch:[{touch:[`auto`,`none`,`manipulation`]}],"touch-x":[{"touch-pan":[`x`,`left`,`right`]}],"touch-y":[{"touch-pan":[`y`,`up`,`down`]}],"touch-pz":[`touch-pinch-zoom`],select:[{select:[`none`,`text`,`all`,`auto`]}],"will-change":[{"will-change":[`auto`,`scroll`,`contents`,`transform`,B,z]}],fill:[{fill:[`none`,...A()]}],"stroke-w":[{stroke:[I,Sn,_n,vn]}],stroke:[{stroke:[`none`,...A()]}],"forced-color-adjust":[{"forced-color-adjust":[`auto`,`none`]}]},conflictingClassGroups:{overflow:[`overflow-x`,`overflow-y`],overscroll:[`overscroll-x`,`overscroll-y`],inset:[`inset-x`,`inset-y`,`start`,`end`,`top`,`right`,`bottom`,`left`],"inset-x":[`right`,`left`],"inset-y":[`top`,`bottom`],flex:[`basis`,`grow`,`shrink`],gap:[`gap-x`,`gap-y`],p:[`px`,`py`,`ps`,`pe`,`pt`,`pr`,`pb`,`pl`],px:[`pr`,`pl`],py:[`pt`,`pb`],m:[`mx`,`my`,`ms`,`me`,`mt`,`mr`,`mb`,`ml`],mx:[`mr`,`ml`],my:[`mt`,`mb`],size:[`w`,`h`],"font-size":[`leading`],"fvn-normal":[`fvn-ordinal`,`fvn-slashed-zero`,`fvn-figure`,`fvn-spacing`,`fvn-fraction`],"fvn-ordinal":[`fvn-normal`],"fvn-slashed-zero":[`fvn-normal`],"fvn-figure":[`fvn-normal`],"fvn-spacing":[`fvn-normal`],"fvn-fraction":[`fvn-normal`],"line-clamp":[`display`,`overflow`],rounded:[`rounded-s`,`rounded-e`,`rounded-t`,`rounded-r`,`rounded-b`,`rounded-l`,`rounded-ss`,`rounded-se`,`rounded-ee`,`rounded-es`,`rounded-tl`,`rounded-tr`,`rounded-br`,`rounded-bl`],"rounded-s":[`rounded-ss`,`rounded-es`],"rounded-e":[`rounded-se`,`rounded-ee`],"rounded-t":[`rounded-tl`,`rounded-tr`],"rounded-r":[`rounded-tr`,`rounded-br`],"rounded-b":[`rounded-br`,`rounded-bl`],"rounded-l":[`rounded-tl`,`rounded-bl`],"border-spacing":[`border-spacing-x`,`border-spacing-y`],"border-w":[`border-w-x`,`border-w-y`,`border-w-s`,`border-w-e`,`border-w-t`,`border-w-r`,`border-w-b`,`border-w-l`],"border-w-x":[`border-w-r`,`border-w-l`],"border-w-y":[`border-w-t`,`border-w-b`],"border-color":[`border-color-x`,`border-color-y`,`border-color-s`,`border-color-e`,`border-color-t`,`border-color-r`,`border-color-b`,`border-color-l`],"border-color-x":[`border-color-r`,`border-color-l`],"border-color-y":[`border-color-t`,`border-color-b`],translate:[`translate-x`,`translate-y`,`translate-none`],"translate-none":[`translate`,`translate-x`,`translate-y`,`translate-z`],"scroll-m":[`scroll-mx`,`scroll-my`,`scroll-ms`,`scroll-me`,`scroll-mt`,`scroll-mr`,`scroll-mb`,`scroll-ml`],"scroll-mx":[`scroll-mr`,`scroll-ml`],"scroll-my":[`scroll-mt`,`scroll-mb`],"scroll-p":[`scroll-px`,`scroll-py`,`scroll-ps`,`scroll-pe`,`scroll-pt`,`scroll-pr`,`scroll-pb`,`scroll-pl`],"scroll-px":[`scroll-pr`,`scroll-pl`],"scroll-py":[`scroll-pt`,`scroll-pb`],touch:[`touch-x`,`touch-y`,`touch-pz`],"touch-x":[`touch`],"touch-y":[`touch`],"touch-pz":[`touch`]},conflictingClassGroupModifiers:{"font-size":[`leading`]},orderSensitiveModifiers:[`*`,`**`,`after`,`backdrop`,`before`,`details-content`,`file`,`first-letter`,`first-line`,`marker`,`placeholder`,`selection`]}});function V(...e){return Ln(p(e))}var H=a();function Rn({className:e,...t}){return(0,H.jsx)(oe,{"data-slot":`avatar`,className:V(`relative flex size-8 shrink-0 overflow-hidden rounded-full`,e),...t})}function zn({className:e,...t}){return(0,H.jsx)(w,{"data-slot":`avatar-image`,className:V(`aspect-square size-full`,e),...t})}function Bn({className:e,...t}){return(0,H.jsx)(y,{"data-slot":`avatar-fallback`,className:V(`bg-muted flex size-full items-center justify-center rounded-full`,e),...t})}function Vn({className:e,children:t,orientation:n=`vertical`,...i}){return(0,H.jsxs)(Be,{"data-slot":`scroll-area`,className:V(`relative`,e),...i,children:[(0,H.jsx)(k,{"data-slot":`scroll-area-viewport`,className:V(`focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1`,n===`horizontal`&&`overflow-x-auto!`),children:t}),(0,H.jsx)(Hn,{orientation:n}),(0,H.jsx)(r,{})]})}function Hn({className:e,orientation:t=`vertical`,...n}){return(0,H.jsx)(T,{"data-slot":`scroll-area-scrollbar`,orientation:t,className:V(`flex touch-none p-px transition-colors select-none`,t===`vertical`&&`h-full w-2.5 border-l border-l-transparent`,t===`horizontal`&&`h-2.5 flex-col border-t border-t-transparent`,e),...n,children:(0,H.jsx)(ne,{"data-slot":`scroll-area-thumb`,className:`bg-border relative flex-1 rounded-full`})})}function Un(e){return[`#FF516A`,`#FFA85C`,`#D669ED`,`#54CB68`,`#28C9B7`,`#2A9EF1`,`#FF719A`][String(e).split(``).reduce((e,t)=>e+t.charCodeAt(0),0)%7]}function Wn({uuid:e}){let[t,n]=(0,P.useState)([]),[r,i]=(0,P.useState)(!0),[a,o]=(0,P.useState)(null);return(0,P.useEffect)(()=>{fetch(`/api/messages/merged/${e}`).then(e=>{if(!e.ok)throw Error(`Failed to fetch messages`);return e.json()}).then(e=>{n(e),i(!1)}).catch(e=>{o(e.message),i(!1)})},[e]),r?(0,H.jsx)(`div`,{className:`p-4 text-center text-slate-600`,children:`加载中...`}):a?(0,H.jsxs)(`div`,{className:`p-4 text-center text-red-500`,children:[`错误: `,a]}):(0,H.jsx)(`div`,{className:`w-full min-h-screen bg-white`,children:(0,H.jsx)(Vn,{className:`h-screen px-4 py-4`,children:(0,H.jsx)(`div`,{className:`w-full max-w-4xl mx-auto`,children:t.map((e,t)=>(0,H.jsx)(Gn,{msg:e,idx:t},t))})})})}function Gn({msg:e,idx:t}){let n=e.user_id??e.sender_id??e.sender?.id??`user${t}`,r=e.nickname||e.card||e.sender?.name||`未知用户`,i=e.avatar||(n&&n!==`user${t}`?`/api/avatar/qq/${n}`:void 0),a=e.time?new Date(e.time*1e3).toLocaleString(`zh-CN`,{hour:`2-digit`,minute:`2-digit`,hour12:!1}):``,o=Un(n);return(0,H.jsxs)(`div`,{className:`flex my-2.5`,children:[(0,H.jsx)(`div`,{className:`w-[50px] min-w-[50px] max-w-[50px] flex justify-center items-end`,children:(0,H.jsxs)(Rn,{className:`h-9 w-9 sticky bottom-2.5 z-[2]`,style:{width:`36px`,height:`36px`,minWidth:`36px`},children:[(0,H.jsx)(zn,{src:i,alt:r,referrerPolicy:`no-referrer`,onError:e=>{e.currentTarget.style.display=`none`}}),(0,H.jsx)(Bn,{className:`bg-gray-300 text-white font-bold text-sm`,children:r[0]||`?`})]})}),(0,H.jsxs)(`div`,{className:`flex-grow`,children:[(0,H.jsx)(`div`,{className:`sticky top-0 z-[1] w-max min-w-0 rounded-[10px] px-2.5 py-1 m-1 text-sm font-bold backdrop-blur-md`,style:{color:o,backgroundColor:`rgba(var(--background-rgb, 255, 255, 255), 0.8)`},children:r}),(0,H.jsxs)(`div`,{className:`w-max min-w-[100px] max-w-[calc(100vw-100px)] m-1 px-2.5 py-1 text-base rounded-r-[10px] rounded-bl-[10px] rounded-tl-none`,style:{backgroundColor:`rgba(136, 136, 136, 0.09)`},children:[(0,H.jsx)(`div`,{className:`whitespace-pre-line`,children:Kn(e.message||[])}),a&&(0,H.jsx)(`div`,{className:`mt-0.5 text-right text-xs text-gray-500`,children:a})]})]})]})}function Kn(e){return Array.isArray(e)?e.map((e,t)=>{let n=e?.type||e?.data?.type,r=e?.data||e||{};if(n===`text`){let n=r.text??e?.text??``;return(0,H.jsx)(`div`,{className:`space-y-0.5`,children:String(n).split(/\n/).map((e,t)=>(0,H.jsx)(`p`,{className:`m-0`,children:e||`\xA0`},t))},t)}if(n===`image`||n===`flash`||n===`bface`){let n=r.url||r.file||e?.url||e?.file;return n?(0,H.jsx)(`div`,{className:`my-1`,children:(0,H.jsx)(`img`,{src:n,alt:`Image`,className:`rounded-md max-w-[200px] cursor-pointer hover:opacity-90 transition-opacity`,referrerPolicy:`no-referrer`,onClick:()=>window.open(n,`_blank`)})},t):(0,H.jsx)(`span`,{children:`[image]`},t)}if(n===`video`||n===`video-loop`){let i=r.url||r.file||e?.url||e?.file;return i?(0,H.jsx)(`div`,{className:`my-1`,children:(0,H.jsx)(`video`,{src:i,controls:n===`video`,autoPlay:n===`video-loop`,muted:n===`video-loop`,loop:n===`video-loop`,className:`rounded-md max-w-[200px]`,style:{width:200}})},t):(0,H.jsx)(`span`,{children:`[video]`},t)}if(n===`record`){let n=r.url||r.file||e?.url||e?.file;return n?(0,H.jsx)(`div`,{className:`my-1`,children:(0,H.jsx)(`audio`,{src:n,controls:!0,className:`max-w-full`})},t):(0,H.jsx)(`span`,{children:`[语音]`},t)}return n===`face`||n===`sface`||n===`at`?(0,H.jsxs)(`span`,{children:[`[`,n,`: `,r.id||r.text||``,`]`]},t):(0,H.jsxs)(`span`,{children:[`[`,n||`unknown`,`]`]},t)}):null}function qn({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`table-container`,className:`relative w-full overflow-x-auto`,children:(0,H.jsx)(`table`,{"data-slot":`table`,className:V(`w-full caption-bottom text-sm`,e),...t})})}function Jn({className:e,...t}){return(0,H.jsx)(`thead`,{"data-slot":`table-header`,className:V(`[&_tr]:border-b`,e),...t})}function Yn({className:e,...t}){return(0,H.jsx)(`tbody`,{"data-slot":`table-body`,className:V(`[&_tr:last-child]:border-0`,e),...t})}function Xn({className:e,...t}){return(0,H.jsx)(`tr`,{"data-slot":`table-row`,className:V(`hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors`,e),...t})}function Zn({className:e,...t}){return(0,H.jsx)(`th`,{"data-slot":`table-head`,className:V(`text-foreground h-10 px-2 text-start align-middle font-medium whitespace-nowrap [&>[role=checkbox]]:translate-y-[2px]`,e),...t})}function U({className:e,...t}){return(0,H.jsx)(`td`,{"data-slot":`table-cell`,className:V(`p-2 align-middle whitespace-nowrap [&>[role=checkbox]]:translate-y-[2px]`,e),...t})}function W({className:e,type:t,...n}){return(0,H.jsx)(`input`,{type:t,"data-slot":`input`,className:V(`file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,`focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]`,`aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,e),...n})}var Qn=yt(`inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,{variants:{variant:{default:`bg-primary text-primary-foreground shadow-xs hover:bg-primary/90`,destructive:`bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60`,outline:`border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50`,secondary:`bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80`,ghost:`hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50`,link:`text-primary underline-offset-4 hover:underline`},size:{default:`h-9 px-4 py-2 has-[>svg]:px-3`,sm:`h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5`,lg:`h-10 rounded-md px-6 has-[>svg]:px-4`,icon:`size-9`}},defaultVariants:{variant:`default`,size:`default`}});function G({className:e,variant:t,size:n,asChild:r=!1,...i}){return(0,H.jsx)(r?vt:`button`,{"data-slot":`button`,className:V(Qn({variant:t,size:n,className:e})),...i})}function $n(){let[e,t]=(0,P.useState)([]),[n,r]=(0,P.useState)(!1),[i,a]=(0,P.useState)(``),[o,s]=(0,P.useState)(1),[c,l]=(0,P.useState)(0),u=()=>{r(!0);let e=new URLSearchParams({page:o.toString(),pageSize:`20`,keyword:i});fetch(`/api/records/forwarded?${e}`).then(e=>e.json()).then(e=>{t(e.items),l(e.total),r(!1)}).catch(e=>{console.error(e),r(!1)})};return(0,P.useEffect)(()=>{u()},[o]),(0,H.jsxs)(`div`,{className:`p-4 space-y-4`,children:[(0,H.jsxs)(`div`,{className:`flex gap-2`,children:[(0,H.jsx)(W,{placeholder:`Search keyword...`,value:i,onChange:e=>a(e.target.value),className:`max-w-sm`}),(0,H.jsx)(G,{onClick:()=>{s(1),u()},children:`Search`}),(0,H.jsx)(G,{variant:`outline`,onClick:()=>{let t=`data:text/csv;charset=utf-8,Time,Brief,Content,QQ Room,QQ Sender,TG Chat
`+e.map(e=>`${new Date(e.time*1e3).toLocaleString()},"${e.brief}","${e.tgMessageText||``}",${e.qqRoomId},${e.qqSenderId},${e.tgChatId}`).join(`
`),n=encodeURI(t),r=document.createElement(`a`);r.setAttribute(`href`,n),r.setAttribute(`download`,`chat_logs.csv`),document.body.appendChild(r),r.click()},children:`Export CSV`})]}),(0,H.jsx)(`div`,{className:`border rounded-md`,children:(0,H.jsxs)(qn,{children:[(0,H.jsx)(Jn,{children:(0,H.jsxs)(Xn,{children:[(0,H.jsx)(Zn,{children:`Time`}),(0,H.jsx)(Zn,{children:`Brief`}),(0,H.jsx)(Zn,{children:`Content`}),(0,H.jsx)(Zn,{children:`QQ Room`}),(0,H.jsx)(Zn,{children:`TG Chat`})]})}),(0,H.jsx)(Yn,{children:n?(0,H.jsx)(Xn,{children:(0,H.jsx)(U,{colSpan:5,className:`text-center`,children:`Loading...`})}):e.map(e=>(0,H.jsxs)(Xn,{children:[(0,H.jsx)(U,{children:new Date(e.time*1e3).toLocaleString()}),(0,H.jsx)(U,{children:e.brief}),(0,H.jsx)(U,{className:`max-w-md truncate`,title:e.tgMessageText,children:e.tgMessageText}),(0,H.jsx)(U,{children:e.qqRoomId}),(0,H.jsx)(U,{children:e.tgChatId})]},e.id))})]})}),(0,H.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,H.jsxs)(`div`,{children:[`Total: `,c]}),(0,H.jsxs)(`div`,{className:`flex gap-2`,children:[(0,H.jsx)(G,{disabled:o<=1,onClick:()=>s(e=>e-1),children:`Prev`}),(0,H.jsx)(G,{disabled:o*20>=c,onClick:()=>s(e=>e+1),children:`Next`})]})]})]})}var K=``;const er={baseURL:K,endpoints:{auth:{login:`${K}/api/auth/login`,loginWithToken:`${K}/api/auth/login/token`,logout:`${K}/api/auth/logout`,me:`${K}/api/auth/me`,createUser:`${K}/api/auth/users`,changePassword:`${K}/api/auth/change-password`},instances:`${K}/api/instances`,statistics:`${K}/api/statistics`}};console.log(`[API Config] Using API origin:`,`relative paths (dev mode)`);var tr=(0,P.createContext)(void 0);function nr({children:e}){let[t,n]=(0,P.useState)(null),[r,i]=(0,P.useState)(null),[a,o]=(0,P.useState)(!0);(0,P.useEffect)(()=>{let e=localStorage.getItem(`admin_token`);e?s(e):o(!1)},[]);let s=async e=>{try{let t=await fetch(er.endpoints.auth.me,{headers:{Authorization:`Bearer ${e}`}});t.ok?(n((await t.json()).user),i(e)):localStorage.removeItem(`admin_token`)}catch(e){console.error(`Token verification failed:`,e),localStorage.removeItem(`admin_token`)}finally{o(!1)}};return(0,H.jsx)(tr.Provider,{value:{user:t,token:r,login:async(e,t)=>{try{let n;if(n=t?await fetch(er.endpoints.auth.login,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({username:e,password:t})}):await fetch(er.endpoints.auth.loginWithToken,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({token:e})}),n.ok){let t=(await n.json()).token||e;return i(t),localStorage.setItem(`admin_token`,t),await s(t),!0}return!1}catch(e){return console.error(`Login failed:`,e),!1}},logout:async()=>{try{r&&await fetch(er.endpoints.auth.logout,{method:`POST`,headers:{Authorization:`Bearer ${r}`}})}catch(e){console.error(`Logout failed:`,e)}finally{n(null),i(null),localStorage.removeItem(`admin_token`)}},isAuthenticated:!!r,isLoading:a},children:e})}function q(){let e=(0,P.useContext)(tr);if(e===void 0)throw Error(`useAuth must be used within an AuthProvider`);return e}function rr({children:e}){let{isAuthenticated:t,isLoading:n}=q();return n?(0,H.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900`,children:(0,H.jsx)(Pe,{className:`h-8 w-8 animate-spin text-blue-600`})}):t?(0,H.jsx)(H.Fragment,{children:e}):(0,H.jsx)(N,{to:`/login`,replace:!0})}function J({className:e,...t}){return(0,H.jsx)(fe,{"data-slot":`label`,className:V(`flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50`,e),...t})}function Y({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`card`,className:V(`bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm card-animate`,e),...t})}function X({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`card-header`,className:V(`@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6`,e),...t})}function Z({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`card-title`,className:V(`leading-none font-semibold`,e),...t})}function ir({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`card-description`,className:V(`text-muted-foreground text-sm`,e),...t})}function Q({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`card-content`,className:V(`px-6`,e),...t})}var ar=yt(`relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current`,{variants:{variant:{default:`bg-card text-card-foreground`,destructive:`text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90`}},defaultVariants:{variant:`default`}});function or({className:e,variant:t,...n}){return(0,H.jsx)(`div`,{"data-slot":`alert`,role:`alert`,className:V(ar({variant:t}),e),...n})}function sr({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`alert-description`,className:V(`text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed`,e),...t})}function cr(){let e=ee(),{login:t}=q(),[n,r]=(0,P.useState)(!1),[i,a]=(0,P.useState)(null),[o,c]=(0,P.useState)(``);return(0,H.jsxs)(`div`,{className:`login-page relative overflow-hidden`,children:[(0,H.jsxs)(`div`,{className:`absolute inset-0 overflow-hidden`,children:[(0,H.jsx)(`div`,{className:`absolute top-0 -left-4 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-10 animate-blob`}),(0,H.jsx)(`div`,{className:`absolute top-0 -right-4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-10 animate-blob animation-delay-2000`}),(0,H.jsx)(`div`,{className:`absolute -bottom-8 left-20 w-96 h-96 bg-indigo-500 rounded-full mix-blend-multiply filter blur-3xl opacity-10 animate-blob animation-delay-4000`})]}),(0,H.jsxs)(Y,{className:`login-card relative z-10 w-full max-w-md mx-auto shadow-2xl border-slate-700/50 bg-slate-900/50 backdrop-blur-xl`,children:[(0,H.jsxs)(X,{className:`space-y-6 pb-6 pt-8`,children:[(0,H.jsx)(`div`,{className:`flex justify-center mb-4`,children:(0,H.jsx)(`div`,{className:`p-3 bg-blue-500/10 rounded-full ring-1 ring-blue-500/20 shadow-lg shadow-blue-500/10`,children:(0,H.jsx)(gt,{className:`w-8 h-8 text-blue-400`})})}),(0,H.jsx)(Z,{className:`text-3xl font-bold text-center bg-gradient-to-r from-blue-400 via-indigo-400 to-purple-400 bg-clip-text text-transparent`,children:`欢迎使用 NapGram`}),(0,H.jsx)(ir,{className:`text-center text-slate-400 text-lg`,children:`请输入您的 Access Token`})]}),(0,H.jsxs)(Q,{className:`space-y-8 pb-8`,children:[(0,H.jsxs)(`form`,{onSubmit:async n=>{n.preventDefault(),a(null),r(!0);try{await t(o)?e(`/admin`):a(`Token 无效或已过期`)}catch{a(`登录失败，请稍后重试`)}finally{r(!1)}},className:`space-y-8`,children:[(0,H.jsxs)(`div`,{className:`space-y-4`,children:[(0,H.jsx)(J,{htmlFor:`token`,className:`text-slate-300 text-base ml-1`,children:`Access Token`}),(0,H.jsxs)(`div`,{className:`relative group`,children:[(0,H.jsx)(W,{id:`token`,type:`password`,placeholder:`sk-...`,value:o,onChange:e=>c(e.target.value),disabled:n,required:!0,className:`login-input pl-4 pr-10 py-6 text-lg bg-slate-800/50 border-slate-700 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-300 group-hover:border-slate-600`}),(0,H.jsx)(gt,{className:`absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500 group-hover:text-slate-400 transition-colors`})]}),(0,H.jsxs)(`p`,{className:`text-sm text-slate-500 flex items-center gap-1.5 ml-1`,children:[(0,H.jsx)(s,{className:`w-4 h-4`}),`检查控制台获取ADMIN_TOKEN`]})]}),i&&(0,H.jsx)(or,{variant:`destructive`,className:`bg-red-500/10 border-red-500/50 text-red-200`,children:(0,H.jsxs)(sr,{className:`flex items-center gap-2`,children:[(0,H.jsx)(`span`,{className:`w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse`}),i]})}),(0,H.jsx)(`div`,{className:`flex justify-center pt-2`,children:(0,H.jsx)(G,{type:`submit`,className:`w-48 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white font-semibold text-lg shadow-lg shadow-blue-500/25 transition-all duration-300 h-12 rounded-full hover:scale-105 active:scale-95`,disabled:n,children:n?(0,H.jsx)(Pe,{className:`mr-2 h-5 w-5 animate-spin`}):`进入系统`})})]}),(0,H.jsx)(`div`,{className:`mt-8 pt-6 border-t border-slate-700/30 flex flex-col items-center gap-3`,children:(0,H.jsxs)(`a`,{href:`https://t.me/+3GElMICv82k5OThl`,target:`_blank`,rel:`noopener noreferrer`,className:`text-slate-400 hover:text-blue-400 transition-colors flex items-center gap-2 group text-sm`,children:[(0,H.jsx)(s,{className:`w-4 h-4 group-hover:rotate-12 transition-transform`}),(0,H.jsx)(`span`,{children:`没有 Token？加入 Telegram 群组咨询`})]})})]})]}),(0,H.jsxs)(`div`,{className:`absolute bottom-6 left-0 right-0 text-center`,children:[(0,H.jsx)(`p`,{className:`text-slate-600 text-sm font-medium`,children:`NapGram Admin Panel`}),(0,H.jsx)(`p`,{className:`text-slate-700 text-xs mt-1`,children:`Version 0.1.0`})]}),(0,H.jsx)(`style`,{children:`
                @keyframes blob {
                    0%, 100% { transform: translate(0, 0) scale(1); }
                    25% { transform: translate(20px, -20px) scale(1.1); }
                    50% { transform: translate(0, 20px) scale(1); }
                    75% { transform: translate(-20px, -10px) scale(0.9); }
                }
                .animate-blob {
                    animation: blob 7s infinite;
                }
                .animation-delay-2000 {
                    animation-delay: 2s;
                }
                .animation-delay-4000 {
                    animation-delay: 4s;
                }
            `})]})}var lr=768;function ur(){let[e,t]=(0,P.useState)(void 0);return(0,P.useEffect)(()=>{let e=window.matchMedia(`(max-width: ${lr-1}px)`),n=()=>{t(window.innerWidth<lr)};return e.addEventListener(`change`,n),t(window.innerWidth<lr),()=>e.removeEventListener(`change`,n)},[]),!!e}function dr({className:e,orientation:t=`horizontal`,decorative:n=!0,...r}){return(0,H.jsx)(le,{"data-slot":`separator`,decorative:n,orientation:t,className:V(`bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:w-px`,e),...r})}function fr({...e}){return(0,H.jsx)(ue,{"data-slot":`sheet`,...e})}function pr({...e}){return(0,H.jsx)(i,{"data-slot":`sheet-portal`,...e})}function mr({className:e,...t}){return(0,H.jsx)(_t,{"data-slot":`sheet-overlay`,className:V(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,e),...t})}function hr({className:e,children:t,side:n=`right`,...r}){return(0,H.jsxs)(pr,{children:[(0,H.jsx)(mr,{}),(0,H.jsxs)(C,{"data-slot":`sheet-content`,className:V(`bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500`,n===`right`&&`data-[state=closed]:slide-out-to-end data-[state=open]:slide-in-from-end inset-y-0 end-0 h-full w-3/4 border-s sm:max-w-sm`,n===`left`&&`data-[state=closed]:slide-out-to-start data-[state=open]:slide-in-from-start inset-y-0 start-0 h-full w-3/4 border-e sm:max-w-sm`,n===`top`&&`data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b`,n===`bottom`&&`data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t`,e),...r,children:[t,(0,H.jsxs)(v,{className:`ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute end-4 top-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none`,children:[(0,H.jsx)(m,{className:`size-4`}),(0,H.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]})}function gr({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`sheet-header`,className:V(`flex flex-col gap-1.5 p-4`,e),...t})}function _r({className:e,...t}){return(0,H.jsx)(g,{"data-slot":`sheet-title`,className:V(`text-foreground font-semibold`,e),...t})}function vr({className:e,...t}){return(0,H.jsx)(ae,{"data-slot":`sheet-description`,className:V(`text-muted-foreground text-sm`,e),...t})}function yr({delayDuration:e=0,...t}){return(0,H.jsx)(E,{"data-slot":`tooltip-provider`,delayDuration:e,...t})}function br({...e}){return(0,H.jsx)(yr,{children:(0,H.jsx)(O,{"data-slot":`tooltip`,...e})})}function xr({...e}){return(0,H.jsx)(f,{"data-slot":`tooltip-trigger`,...e})}function Sr({className:e,sideOffset:t=0,children:r,...i}){return(0,H.jsx)(te,{children:(0,H.jsxs)(ze,{"data-slot":`tooltip-content`,sideOffset:t,className:V(`bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance`,e),...i,children:[r,(0,H.jsx)(n,{className:`bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]`})]})})}var Cr=`sidebar_state`,wr=3600*24*7,Tr=`16rem`,Er=`18rem`,Dr=`3rem`,Or=`b`,kr=P.createContext(null);function Ar(){let e=P.useContext(kr);if(!e)throw Error(`useSidebar must be used within a SidebarProvider.`);return e}function jr({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:i,children:a,...o}){let s=ur(),[c,l]=P.useState(!1),[u,d]=P.useState(e),f=t??u,p=P.useCallback(e=>{let t=typeof e==`function`?e(f):e;n?n(t):d(t),document.cookie=`${Cr}=${t}; path=/; max-age=${wr}`},[n,f]),m=P.useCallback(()=>s?l(e=>!e):p(e=>!e),[s,p,l]);P.useEffect(()=>{let e=e=>{e.key===Or&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),m())};return window.addEventListener(`keydown`,e),()=>window.removeEventListener(`keydown`,e)},[m]);let h=f?`expanded`:`collapsed`,g=P.useMemo(()=>({state:h,open:f,setOpen:p,isMobile:s,openMobile:c,setOpenMobile:l,toggleSidebar:m}),[h,f,p,s,c,l,m]);return(0,H.jsx)(kr.Provider,{value:g,children:(0,H.jsx)(yr,{delayDuration:0,children:(0,H.jsx)(`div`,{"data-slot":`sidebar-wrapper`,style:{"--sidebar-width":Tr,"--sidebar-width-icon":Dr,...i},className:V(`group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full`,r),...o,children:a})})})}function Mr({side:e=`left`,variant:t=`sidebar`,collapsible:n=`offcanvas`,className:r,children:i,...a}){let{isMobile:o,state:s,openMobile:c,setOpenMobile:l}=Ar();return n===`none`?(0,H.jsx)(`div`,{"data-slot":`sidebar`,className:V(`bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col`,r),...a,children:i}):o?(0,H.jsx)(fr,{open:c,onOpenChange:l,...a,children:(0,H.jsxs)(hr,{"data-sidebar":`sidebar`,"data-slot":`sidebar`,"data-mobile":`true`,className:`bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden`,style:{"--sidebar-width":Er},side:e,children:[(0,H.jsxs)(gr,{className:`sr-only`,children:[(0,H.jsx)(_r,{children:`Sidebar`}),(0,H.jsx)(vr,{children:`Displays the mobile sidebar.`})]}),(0,H.jsx)(`div`,{className:`flex h-full w-full flex-col`,children:i})]})}):(0,H.jsxs)(`div`,{className:`group peer text-sidebar-foreground hidden md:block`,"data-state":s,"data-collapsible":s===`collapsed`?n:``,"data-variant":t,"data-side":e,"data-slot":`sidebar`,children:[(0,H.jsx)(`div`,{"data-slot":`sidebar-gap`,className:V(`relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear`,`group-data-[collapsible=offcanvas]:w-0`,`group-data-[side=right]:rotate-180`,t===`floating`||t===`inset`?`group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]`:`group-data-[collapsible=icon]:w-(--sidebar-width-icon)`)}),(0,H.jsx)(`div`,{"data-slot":`sidebar-container`,className:V(`fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[inset-inline,width] duration-200 ease-linear md:flex`,e===`left`?`start-0 group-data-[collapsible=offcanvas]:-start-[calc(var(--sidebar-width))]`:`end-0 group-data-[collapsible=offcanvas]:-end-[calc(var(--sidebar-width))]`,t===`floating`||t===`inset`?`p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]`:`group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-e group-data-[side=right]:border-s`,r),...a,children:(0,H.jsx)(`div`,{"data-sidebar":`sidebar`,"data-slot":`sidebar-inner`,className:`bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm`,children:i})})]})}function Nr({className:e,onClick:t,...n}){let{toggleSidebar:r}=Ar();return(0,H.jsxs)(G,{"data-sidebar":`trigger`,"data-slot":`sidebar-trigger`,variant:`ghost`,size:`icon`,className:V(`size-7`,e),onClick:e=>{t?.(e),r()},...n,children:[(0,H.jsx)(ke,{}),(0,H.jsx)(`span`,{className:`sr-only`,children:`Toggle Sidebar`})]})}function Pr({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`sidebar-inset`,className:V(`bg-background relative flex w-full flex-1 flex-col`,`md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ms-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ms-2`,e),...t})}function Fr({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`sidebar-header`,"data-sidebar":`header`,className:V(`flex flex-col gap-2 p-2`,e),...t})}function Ir({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`sidebar-footer`,"data-sidebar":`footer`,className:V(`flex flex-col gap-2 p-2`,e),...t})}function Lr({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`sidebar-content`,"data-sidebar":`content`,className:V(`flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden`,e),...t})}function Rr({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`sidebar-group`,"data-sidebar":`group`,className:V(`relative flex w-full min-w-0 flex-col p-2`,e),...t})}function zr({className:e,asChild:t=!1,...n}){return(0,H.jsx)(t?vt:`div`,{"data-slot":`sidebar-group-label`,"data-sidebar":`group-label`,className:V(`text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0`,`group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0`,e),...n})}function Br({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`sidebar-group-content`,"data-sidebar":`group-content`,className:V(`w-full text-sm`,e),...t})}function Vr({className:e,...t}){return(0,H.jsx)(`ul`,{"data-slot":`sidebar-menu`,"data-sidebar":`menu`,className:V(`flex w-full min-w-0 flex-col gap-1`,e),...t})}function Hr({className:e,...t}){return(0,H.jsx)(`li`,{"data-slot":`sidebar-menu-item`,"data-sidebar":`menu-item`,className:V(`group/menu-item relative`,e),...t})}var Ur=yt(`peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-start text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pe-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0`,{variants:{variant:{default:`hover:bg-sidebar-accent hover:text-sidebar-accent-foreground`,outline:`bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]`},size:{default:`h-8 text-sm`,sm:`h-7 text-xs`,lg:`h-12 text-sm group-data-[collapsible=icon]:p-0!`}},defaultVariants:{variant:`default`,size:`default`}});function Wr({asChild:e=!1,isActive:t=!1,variant:n=`default`,size:r=`default`,tooltip:i,className:a,...o}){let s=e?vt:`button`,{isMobile:c,state:l}=Ar(),u=(0,H.jsx)(s,{"data-slot":`sidebar-menu-button`,"data-sidebar":`menu-button`,"data-size":r,"data-active":t,className:V(Ur({variant:n,size:r}),a),...o});return i?(typeof i==`string`&&(i={children:i}),(0,H.jsxs)(br,{children:[(0,H.jsx)(xr,{asChild:!0,children:u}),(0,H.jsx)(Sr,{side:`right`,align:`center`,hidden:l!==`collapsed`||c,...i})]})):u}var Gr=[{name:`仪表板`,href:`/admin`,icon:ut},{name:`配对管理`,href:`/admin/pairs`,icon:xe},{name:`实例管理`,href:`/admin/instances`,icon:Ae},{name:`消息记录`,href:`/admin/messages`,icon:Qe},{name:`统计分析`,href:`/admin/statistics`,icon:D},{name:`系统日志`,href:`/admin/logs`,icon:mt},{name:`系统设置`,href:`/admin/settings`,icon:A}];function Kr(){let e=et();return(0,H.jsxs)(Mr,{children:[(0,H.jsx)(Fr,{className:`border-b border-sidebar-border px-3 py-4`,children:(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(`div`,{className:`flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground`,children:(0,H.jsx)(`span`,{className:`text-sm font-bold`,children:`N`})}),(0,H.jsxs)(`div`,{className:`flex flex-col`,children:[(0,H.jsx)(`span`,{className:`text-sm font-semibold`,children:`NapGram`}),(0,H.jsx)(`span`,{className:`text-xs text-muted-foreground`,children:`管理后台`})]})]})}),(0,H.jsx)(Lr,{children:(0,H.jsxs)(Rr,{children:[(0,H.jsx)(zr,{children:`导航`}),(0,H.jsx)(Br,{children:(0,H.jsx)(Vr,{children:Gr.map(t=>{let n=e.pathname===t.href||t.href!==`/admin`&&e.pathname.startsWith(t.href),r=t.icon;return(0,H.jsx)(Hr,{children:(0,H.jsx)(Wr,{asChild:!0,isActive:n,tooltip:t.name,children:(0,H.jsxs)(_,{to:t.href,children:[(0,H.jsx)(r,{className:`h-4 w-4`}),(0,H.jsx)(`span`,{children:t.name})]})})},t.name)})})})]})}),(0,H.jsx)(Ir,{className:`border-t border-sidebar-border p-3`,children:(0,H.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Version 0.1.0`})})]})}var qr=3600*24*7;function Jr(e){if(typeof document>`u`)return;let t=`; ${document.cookie}`.split(`; ${e}=`);if(t.length===2)return t.pop()?.split(`;`).shift()}function Yr(e,t,n=qr){typeof document>`u`||(document.cookie=`${e}=${t}; path=/; max-age=${n}`)}function Xr(e){typeof document>`u`||(document.cookie=`${e}=; path=/; max-age=0`)}var Zr=`system`,Qr=`vite-ui-theme`,$r=3600*24*365,ei=(0,P.createContext)({defaultTheme:Zr,resolvedTheme:`light`,theme:Zr,setTheme:()=>null,resetTheme:()=>null});function ti({children:e,defaultTheme:t=Zr,storageKey:n=Qr,...r}){let[i,a]=(0,P.useState)(()=>Jr(n)||t),o=(0,P.useMemo)(()=>i===`system`?window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`:i,[i]);return(0,P.useEffect)(()=>{let e=window.document.documentElement,t=window.matchMedia(`(prefers-color-scheme: dark)`),n=t=>{e.classList.remove(`light`,`dark`),e.classList.add(t)},r=()=>{i===`system`&&n(t.matches?`dark`:`light`)};return n(o),t.addEventListener(`change`,r),()=>t.removeEventListener(`change`,r)},[i,o]),(0,H.jsx)(ei,{value:{defaultTheme:t,resolvedTheme:o,resetTheme:()=>{Xr(n),a(Zr)},theme:i,setTheme:e=>{Yr(n,e,$r),a(e)}},...r,children:e})}const ni=()=>{let e=(0,P.useContext)(ei);if(!e)throw Error(`useTheme must be used within a ThemeProvider`);return e};function ri({...e}){return(0,H.jsx)(c,{"data-slot":`dropdown-menu`,...e})}function ii({...e}){return(0,H.jsx)(Ve,{"data-slot":`dropdown-menu-trigger`,...e})}function ai({className:e,sideOffset:t=4,...n}){return(0,H.jsx)(u,{children:(0,H.jsx)(o,{"data-slot":`dropdown-menu-content`,sideOffset:t,className:V(`bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md`,e),...n})})}function oi({className:e,inset:t,variant:n=`default`,...r}){return(0,H.jsx)(dt,{"data-slot":`dropdown-menu-item`,"data-inset":t,"data-variant":n,className:V(`focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:ps-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,e),...r})}function si({className:e,inset:t,...n}){return(0,H.jsx)(M,{"data-slot":`dropdown-menu-label`,"data-inset":t,className:V(`px-2 py-1.5 text-sm font-medium data-[inset]:ps-8`,e),...n})}function ci({className:e,...t}){return(0,H.jsx)(re,{"data-slot":`dropdown-menu-separator`,className:V(`bg-border -mx-1 my-1 h-px`,e),...t})}function li(){let{theme:e,setTheme:t}=ni();return(0,P.useEffect)(()=>{let t=e===`dark`?`#020817`:`#fff`,n=document.querySelector(`meta[name='theme-color']`);n&&n.setAttribute(`content`,t)},[e]),(0,H.jsxs)(ri,{modal:!1,children:[(0,H.jsx)(ii,{asChild:!0,children:(0,H.jsxs)(G,{variant:`ghost`,size:`icon`,className:`scale-95 rounded-full`,children:[(0,H.jsx)(me,{className:`size-[1.2rem] scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90`}),(0,H.jsx)(Me,{className:`absolute size-[1.2rem] scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0`}),(0,H.jsx)(`span`,{className:`sr-only`,children:`Toggle theme`})]})}),(0,H.jsxs)(ai,{align:`end`,children:[(0,H.jsxs)(oi,{onClick:()=>t(`light`),children:[`Light`,` `,(0,H.jsx)(l,{size:14,className:V(`ms-auto`,e!==`light`&&`hidden`)})]}),(0,H.jsxs)(oi,{onClick:()=>t(`dark`),children:[`Dark`,(0,H.jsx)(l,{size:14,className:V(`ms-auto`,e!==`dark`&&`hidden`)})]}),(0,H.jsxs)(oi,{onClick:()=>t(`system`),children:[`System`,(0,H.jsx)(l,{size:14,className:V(`ms-auto`,e!==`system`&&`hidden`)})]})]})]})}function ui(){let e=ee(),{logout:t}=q();return(0,H.jsxs)(`header`,{className:`sticky top-0 z-50 flex h-16 shrink-0 items-center gap-3 border-b border-sidebar-border bg-background px-4`,children:[(0,H.jsx)(Nr,{className:`-ml-1`}),(0,H.jsx)(dr,{orientation:`vertical`,className:`h-6`}),(0,H.jsxs)(`div`,{className:`flex flex-1 items-center justify-between`,children:[(0,H.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,H.jsx)(`h1`,{className:`text-lg font-semibold`,children:`NapGram 管理后台`})}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(li,{}),(0,H.jsxs)(ri,{children:[(0,H.jsx)(ii,{asChild:!0,children:(0,H.jsx)(G,{variant:`ghost`,className:`relative h-9 w-9 rounded-full`,children:(0,H.jsx)(Rn,{className:`h-9 w-9`,children:(0,H.jsx)(Bn,{className:`bg-primary text-primary-foreground`,children:`A`})})})}),(0,H.jsxs)(ai,{className:`w-56`,align:`end`,forceMount:!0,children:[(0,H.jsx)(si,{className:`font-normal`,children:(0,H.jsxs)(`div`,{className:`flex flex-col space-y-1`,children:[(0,H.jsx)(`p`,{className:`text-sm font-medium leading-none`,children:`管理员`}),(0,H.jsx)(`p`,{className:`text-xs leading-none text-muted-foreground`,children:`admin@napgram.com`})]})}),(0,H.jsx)(ci,{}),(0,H.jsxs)(oi,{onClick:()=>e(`/admin/profile`),children:[(0,H.jsx)($e,{className:`mr-2 h-4 w-4`}),(0,H.jsx)(`span`,{children:`个人资料`})]}),(0,H.jsxs)(oi,{onClick:()=>e(`/admin/settings`),children:[(0,H.jsx)(A,{className:`mr-2 h-4 w-4`}),(0,H.jsx)(`span`,{children:`系统设置`})]}),(0,H.jsx)(ci,{}),(0,H.jsxs)(oi,{onClick:async()=>{await t(),e(`/login`)},className:`text-red-600 dark:text-red-400`,children:[(0,H.jsx)(Ie,{className:`mr-2 h-4 w-4`}),(0,H.jsx)(`span`,{children:`登出`})]})]})]})]})]})]})}function di(){return(0,H.jsxs)(jr,{defaultOpen:localStorage.getItem(`sidebar_state`)!==`false`,children:[(0,H.jsx)(Kr,{}),(0,H.jsxs)(Pr,{className:`flex flex-col h-screen min-h-0`,children:[(0,H.jsx)(ui,{}),(0,H.jsx)(`main`,{className:`flex-1 overflow-hidden p-6 bg-background page-animate min-h-0`,children:(0,H.jsx)(pe,{})})]})]})}function fi(){let{token:e}=q(),[t,n]=(0,P.useState)(null),[r,i]=(0,P.useState)([]),[a,o]=(0,P.useState)(!0);(0,P.useEffect)(()=>{s(),c();let e=setInterval(()=>{s()},3e4);return()=>clearInterval(e)},[e]);let s=async()=>{try{let t=await fetch(`/api/admin/statistics/overview`,{headers:{Authorization:`Bearer ${e}`}});t.ok&&n((await t.json()).data)}catch(e){console.error(`Failed to fetch stats:`,e)}finally{o(!1)}},c=async()=>{try{let t=await fetch(`/api/admin/statistics/messages/trend?days=7`,{headers:{Authorization:`Bearer ${e}`}});t.ok&&i((await t.json()).data)}catch(e){console.error(`Failed to fetch trend:`,e)}};return a?(0,H.jsx)(`div`,{className:`p-6`,children:`加载中...`}):(0,H.jsxs)(`div`,{className:`space-y-6`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`仪表板`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`系统概览和关键指标`})]}),(0,H.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2 lg:grid-cols-4`,children:[(0,H.jsxs)(Y,{children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`转发配对`}),(0,H.jsx)(xe,{className:`h-4 w-4 text-gray-600 dark:text-gray-400`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsx)(`div`,{className:`text-2xl font-bold`,children:t?.pairCount||0}),(0,H.jsx)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:`活跃的 QQ-TG 配对`})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`实例数 量`}),(0,H.jsx)(Ae,{className:`h-4 w-4 text-gray-600 dark:text-gray-400`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsx)(`div`,{className:`text-2xl font-bold`,children:t?.instanceCount||0}),(0,H.jsx)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:`运行中的实例`})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`消息总数`}),(0,H.jsx)(Qe,{className:`h-4 w-4 text-gray-600 dark:text-gray-400`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsx)(`div`,{className:`text-2xl font-bold`,children:t?.messageCount?.toLocaleString()||0}),(0,H.jsxs)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:[`今日: `,t?.todayMessageCount||0]})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`系统状态`}),(0,H.jsx)(He,{className:`h-4 w-4 text-gray-600 dark:text-gray-400`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[(0,H.jsx)(`div`,{className:`h-3 w-3 rounded-full ${t?.status===`healthy`?`bg-green-500`:t?.status===`degraded`?`bg-yellow-500`:`bg-red-500`}`}),(0,H.jsx)(`span`,{className:`text-sm font-medium capitalize`,children:t?.status===`healthy`?`正常`:t?.status===`degraded`?`降级`:`异常`})]}),(0,H.jsxs)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:[`日均: `,t?.avgMessagesPerDay||0,` 条`]})]})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsxs)(Z,{className:`flex items-center`,children:[(0,H.jsx)(b,{className:`h-5 w-5 mr-2`}),`消息趋势（近7天）`]})}),(0,H.jsx)(Q,{children:(0,H.jsx)(se,{width:`100%`,height:300,children:(0,H.jsxs)(Ne,{data:r,children:[(0,H.jsx)(we,{strokeDasharray:`3 3`,className:`stroke-gray-200 dark:stroke-gray-700`}),(0,H.jsx)(lt,{dataKey:`date`,className:`text-xs`,tickFormatter:e=>new Date(e).toLocaleDateString(`zh-CN`,{month:`short`,day:`numeric`})}),(0,H.jsx)(be,{className:`text-xs`}),(0,H.jsx)(pt,{labelFormatter:e=>new Date(e).toLocaleDateString(`zh-CN`),formatter:e=>[`${e} 条消息`,`数量`]}),(0,H.jsx)(ht,{type:`monotone`,dataKey:`count`,stroke:`#3b82f6`,strokeWidth:2,dot:{fill:`#3b82f6`,r:4},activeDot:{r:6}})]})})})]}),(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsx)(Z,{children:`快速操作`})}),(0,H.jsxs)(Q,{className:`grid gap-4 md:grid-cols-2`,children:[(0,H.jsxs)(`a`,{href:`/admin/pairs`,className:`flex items-center p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors`,children:[(0,H.jsx)(xe,{className:`h-5 w-5 mr-3 text-blue-600`}),(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h3`,{className:`font-medium`,children:`管理配对`}),(0,H.jsx)(`p`,{className:`text-sm text-gray-600 dark:text-gray-400`,children:`添加或编辑 QQ-TG 转发配对`})]})]}),(0,H.jsxs)(`a`,{href:`/admin/instances`,className:`flex items-center p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors`,children:[(0,H.jsx)(Ae,{className:`h-5 w-5 mr-3 text-blue-600`}),(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h3`,{className:`font-medium`,children:`管理实例`}),(0,H.jsx)(`p`,{className:`text-sm text-gray-600 dark:text-gray-400`,children:`配置 Bot 实例和连接`})]})]})]})]})]})}function pi({...e}){return(0,H.jsx)(ue,{"data-slot":`dialog`,...e})}function mi({...e}){return(0,H.jsx)(i,{"data-slot":`dialog-portal`,...e})}function hi({className:e,...t}){return(0,H.jsx)(_t,{"data-slot":`dialog-overlay`,className:V(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,e),...t})}function gi({className:e,children:t,showCloseButton:n=!0,...r}){return(0,H.jsxs)(mi,{"data-slot":`dialog-portal`,children:[(0,H.jsx)(hi,{}),(0,H.jsxs)(C,{"data-slot":`dialog-content`,className:V(`bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg`,e),...r,children:[t,n&&(0,H.jsxs)(v,{"data-slot":`dialog-close`,className:`ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute end-4 top-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,children:[(0,H.jsx)(m,{}),(0,H.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]})}function _i({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`dialog-header`,className:V(`flex flex-col gap-2 text-center sm:text-start`,e),...t})}function vi({className:e,...t}){return(0,H.jsx)(`div`,{"data-slot":`dialog-footer`,className:V(`flex flex-col-reverse gap-2 sm:flex-row sm:justify-end`,e),...t})}function yi({className:e,...t}){return(0,H.jsx)(g,{"data-slot":`dialog-title`,className:V(`text-lg leading-none font-semibold`,e),...t})}function bi({...e}){return(0,H.jsx)(st,{"data-slot":`select`,...e})}function xi({...e}){return(0,H.jsx)(Ge,{"data-slot":`select-value`,...e})}function Si({className:e,size:t=`default`,children:n,...r}){return(0,H.jsxs)(Ze,{"data-slot":`select-trigger`,"data-size":t,className:V(`border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,e),...r,children:[n,(0,H.jsx)(Se,{asChild:!0,children:(0,H.jsx)(d,{className:`size-4 opacity-50`})})]})}function Ci({className:e,children:t,position:n=`popper`,...r}){return(0,H.jsx)(Ue,{children:(0,H.jsxs)(Le,{"data-slot":`select-content`,className:V(`bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md`,n===`popper`&&`data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1`,e),position:n,...r,children:[(0,H.jsx)(Ti,{}),(0,H.jsx)(Fe,{className:V(`p-1`,n===`popper`&&`h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1`),children:t}),(0,H.jsx)(Ei,{})]})})}function wi({className:e,children:t,...n}){return(0,H.jsxs)(Ye,{"data-slot":`select-item`,className:V(`focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 ps-2 pe-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2`,e),...n,children:[(0,H.jsx)(`span`,{className:`absolute end-2 flex size-3.5 items-center justify-center`,children:(0,H.jsx)(rt,{children:(0,H.jsx)(l,{className:`size-4`})})}),(0,H.jsx)(Ee,{children:t})]})}function Ti({className:e,...t}){return(0,H.jsx)(je,{"data-slot":`select-scroll-up-button`,className:V(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,H.jsx)(ft,{className:`size-4`})})}function Ei({className:e,...t}){return(0,H.jsx)(Oe,{"data-slot":`select-scroll-down-button`,className:V(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,H.jsx)(d,{className:`size-4`})})}function Di(){let{token:e}=q(),[t,n]=(0,P.useState)([]),[r,i]=(0,P.useState)(!0),[a,o]=(0,P.useState)(!1),[s,c]=(0,P.useState)(null),[l,u]=(0,P.useState)({qqRoomId:``,tgChatId:``,tgThreadId:``,instanceId:``,forwardMode:`11`,nicknameMode:`11`,ignoreRegex:``,ignoreSenders:``});(0,P.useEffect)(()=>{d()},[e]);let d=async()=>{try{let t=await fetch(`/api/admin/pairs?withNames=true`,{headers:{Authorization:`Bearer ${e}`}});t.ok&&n((await t.json()).items||[])}catch(e){console.error(`Failed to fetch pairs:`,e)}finally{i(!1)}},f=async r=>{if(confirm(`确定要删除此配对吗？`))try{(await fetch(`/api/admin/pairs/${r}`,{method:`DELETE`,headers:{Authorization:`Bearer ${e}`}})).ok&&n(t.filter(e=>e.id!==r))}catch(e){console.error(`Failed to delete pair:`,e)}},p=()=>{c(null),u({qqRoomId:``,tgChatId:``,tgThreadId:``,instanceId:``,forwardMode:`11`,nicknameMode:`11`,ignoreRegex:``,ignoreSenders:``}),o(!0)},m=e=>{c(e),u({qqRoomId:e.qqRoomId,tgChatId:e.tgChatId,tgThreadId:e.tgThreadId?String(e.tgThreadId):``,instanceId:String(e.instanceId),forwardMode:e.forwardMode||`11`,nicknameMode:e.nicknameMode||`11`,ignoreRegex:e.ignoreRegex||``,ignoreSenders:e.ignoreSenders||``}),o(!0)},h=async()=>{if(!l.qqRoomId||!l.tgChatId){tt.error(`请填写 QQ 群 ID 和 TG Chat ID`);return}let t={qqRoomId:l.qqRoomId,tgChatId:l.tgChatId,tgThreadId:l.tgThreadId?Number(l.tgThreadId):null,instanceId:l.instanceId?Number(l.instanceId):0,forwardMode:l.forwardMode||null,nicknameMode:l.nicknameMode||null,ignoreRegex:l.ignoreRegex||null,ignoreSenders:l.ignoreSenders||null},n=!!s,r=n?`/api/admin/pairs/${s.id}`:`/api/admin/pairs`,i=n?`PUT`:`POST`;try{let a=await fetch(r,{method:i,headers:{Authorization:`Bearer ${e}`,"Content-Type":`application/json`},body:JSON.stringify(t)});if(a.ok)tt.success(n?`已更新配对`:`已创建配对`),o(!1),d();else{let e=await a.json().catch(()=>null);tt.error(e?.error||`操作失败`)}}catch{tt.error(`网络错误，请重试`)}},g=e=>{if(!e)return`默认`;switch(e){case`00`:return`全禁用`;case`01`:return`仅 TG→QQ`;case`10`:return`仅 QQ→TG`;case`11`:return`双向`;default:return e}};return r?(0,H.jsx)(`div`,{className:`p-6`,children:`加载中...`}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(`div`,{className:`space-y-6`,children:[(0,H.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`配对管理`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`管理 QQ 群与 Telegram 聊天的转发配对`})]}),(0,H.jsxs)(G,{onClick:p,children:[(0,H.jsx)(it,{className:`h-4 w-4 mr-2`}),`添加配对`]})]}),(0,H.jsx)(Y,{children:(0,H.jsx)(`div`,{className:`overflow-x-auto`,children:(0,H.jsxs)(`table`,{className:`w-full`,children:[(0,H.jsx)(`thead`,{className:`bg-gray-50 dark:bg-gray-800 border-b`,children:(0,H.jsxs)(`tr`,{children:[(0,H.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`ID`}),(0,H.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`QQ 群 ID`}),(0,H.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`TG Chat ID`}),(0,H.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`话题 ID`}),(0,H.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`转发模式`}),(0,H.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`昵称模式`}),(0,H.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`实例 ID`}),(0,H.jsx)(`th`,{className:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:`操作`})]})}),(0,H.jsx)(`tbody`,{className:`bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700`,children:t.length===0?(0,H.jsx)(`tr`,{children:(0,H.jsx)(`td`,{colSpan:8,className:`px-6 py-12 text-center text-gray-500 dark:text-gray-400`,children:`暂无配对数据`})}):t.map(e=>(0,H.jsxs)(`tr`,{className:`hover:bg-gray-50 dark:hover:bg-gray-800`,children:[(0,H.jsxs)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white`,children:[`#`,e.id]}),(0,H.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300`,children:(0,H.jsxs)(`div`,{className:`flex flex-col`,children:[(0,H.jsx)(`span`,{children:e.qqRoomId}),e.qqRoomName&&(0,H.jsx)(`span`,{className:`text-xs text-muted-foreground truncate`,children:e.qqRoomName})]})}),(0,H.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300`,children:(0,H.jsxs)(`div`,{className:`flex flex-col`,children:[(0,H.jsx)(`span`,{children:e.tgChatId}),e.tgChatName&&(0,H.jsx)(`span`,{className:`text-xs text-muted-foreground truncate`,children:e.tgChatName})]})}),(0,H.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300`,children:e.tgThreadId||`-`}),(0,H.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,H.jsx)(`span`,{className:`px-2 py-1 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200`,children:g(e.forwardMode)})}),(0,H.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,H.jsx)(`span`,{className:`px-2 py-1 text-xs font-medium rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200`,children:g(e.nicknameMode)})}),(0,H.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300`,children:e.instanceId}),(0,H.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-right text-sm font-medium`,children:(0,H.jsxs)(`div`,{className:`flex justify-end space-x-2`,children:[(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>m(e),children:(0,H.jsx)(We,{className:`h-4 w-4`})}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>f(e.id),className:`text-red-600 hover:text-red-700 hover:bg-red-50`,children:(0,H.jsx)(ge,{className:`h-4 w-4`})})]})})]},e.id))})]})})})]}),(0,H.jsx)(pi,{open:a,onOpenChange:o,children:(0,H.jsxs)(gi,{children:[(0,H.jsx)(_i,{children:(0,H.jsx)(yi,{children:s?`编辑配对`:`新建配对`})}),(0,H.jsxs)(`div`,{className:`grid gap-3`,children:[(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`QQ 群 ID`}),(0,H.jsx)(W,{value:l.qqRoomId,onChange:e=>u({...l,qqRoomId:e.target.value}),placeholder:`例如 123456`})]}),(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`TG Chat ID`}),(0,H.jsx)(W,{value:l.tgChatId,onChange:e=>u({...l,tgChatId:e.target.value}),placeholder:`例如 -100123456`})]}),(0,H.jsxs)(`div`,{className:`grid grid-cols-2 gap-2`,children:[(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`话题 ID（可选）`}),(0,H.jsx)(W,{value:l.tgThreadId,onChange:e=>u({...l,tgThreadId:e.target.value})})]}),(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`实例 ID`}),(0,H.jsx)(W,{value:l.instanceId,onChange:e=>u({...l,instanceId:e.target.value}),placeholder:`默认 0`})]})]}),(0,H.jsxs)(`div`,{className:`grid grid-cols-2 gap-2`,children:[(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`转发模式`}),(0,H.jsxs)(bi,{value:l.forwardMode,onValueChange:e=>u({...l,forwardMode:e}),children:[(0,H.jsx)(Si,{children:(0,H.jsx)(xi,{placeholder:`选择转发模式`})}),(0,H.jsxs)(Ci,{children:[(0,H.jsx)(wi,{value:`11`,children:`双向`}),(0,H.jsx)(wi,{value:`10`,children:`仅 QQ→TG`}),(0,H.jsx)(wi,{value:`01`,children:`仅 TG→QQ`}),(0,H.jsx)(wi,{value:`00`,children:`全禁用`})]})]})]}),(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`昵称模式`}),(0,H.jsxs)(bi,{value:l.nicknameMode,onValueChange:e=>u({...l,nicknameMode:e}),children:[(0,H.jsx)(Si,{children:(0,H.jsx)(xi,{placeholder:`选择昵称模式`})}),(0,H.jsxs)(Ci,{children:[(0,H.jsx)(wi,{value:`11`,children:`双向显示`}),(0,H.jsx)(wi,{value:`10`,children:`仅 QQ→TG`}),(0,H.jsx)(wi,{value:`01`,children:`仅 TG→QQ`}),(0,H.jsx)(wi,{value:`00`,children:`不显示`})]})]})]})]}),(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`忽略正则（可选）`}),(0,H.jsx)(W,{value:l.ignoreRegex,onChange:e=>u({...l,ignoreRegex:e.target.value}),placeholder:`匹配则忽略转发`})]}),(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`忽略发送者（逗号分隔）`}),(0,H.jsx)(W,{value:l.ignoreSenders,onChange:e=>u({...l,ignoreSenders:e.target.value}),placeholder:`如 12345,67890`})]})]}),(0,H.jsxs)(vi,{className:`pt-4`,children:[(0,H.jsx)(G,{variant:`outline`,onClick:()=>o(!1),children:`取消`}),(0,H.jsx)(G,{onClick:h,children:s?`保存修改`:`创建`})]})]})})]})}function Oi(){let{token:e}=q(),[t,n]=(0,P.useState)([]),[r,i]=(0,P.useState)(!0),[a,o]=(0,P.useState)(!1),[s,c]=(0,P.useState)(null),[l,u]=(0,P.useState)({owner:``,workMode:``,qqBotId:``,isSetup:!1});(0,P.useEffect)(()=>{d()},[e]);let d=async()=>{try{let t=await fetch(`/api/admin/instances`,{headers:{Authorization:`Bearer ${e}`}});t.ok&&n((await t.json()).items||[])}catch(e){console.error(`Failed to fetch instances:`,e)}finally{i(!1)}},f=async r=>{if(confirm(`确定要删除此实例吗？这将同时删除关联的所有配对。`))try{(await fetch(`/api/admin/instances/${r}`,{method:`DELETE`,headers:{Authorization:`Bearer ${e}`}})).ok&&n(t.filter(e=>e.id!==r))}catch(e){console.error(`Failed to delete instance:`,e)}},p=()=>{c(null),u({owner:``,workMode:``,qqBotId:``,isSetup:!1}),o(!0)},m=e=>{c(e),u({owner:e.owner,workMode:e.workMode||``,qqBotId:e.qqBot?.id?String(e.qqBot.id):``,isSetup:e.isSetup}),o(!0)},h=async()=>{if(!s&&!l.owner){tt.error(`请填写 owner`);return}let t={workMode:l.workMode,isSetup:l.isSetup};s?(l.owner&&(t.owner=l.owner),l.qqBotId&&(t.qqBotId=Number(l.qqBotId))):(t.owner=l.owner,t.qqBotId=l.qqBotId?Number(l.qqBotId):void 0);let n=!!s,r=n?`/api/admin/instances/${s.id}`:`/api/admin/instances`,i=n?`PUT`:`POST`;try{let a=await fetch(r,{method:i,headers:{Authorization:`Bearer ${e}`,"Content-Type":`application/json`},body:JSON.stringify(t)});if(a.ok)tt.success(n?`实例已更新`:`实例已创建`),o(!1),d();else{let e=await a.json().catch(()=>null);tt.error(e?.error||`操作失败`)}}catch{tt.error(`网络错误，请重试`)}},g=e=>{if(!e.qqBot)return(0,H.jsx)(`span`,{className:`px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200`,children:`未配置`});let t=e.isSetup;return(0,H.jsx)(`span`,{className:`px-2 py-1 text-xs font-medium rounded-full flex items-center ${t?`bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200`:`bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200`}`,children:t?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Xe,{className:`h-3 w-3 mr-1`}),`在线`]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Ce,{className:`h-3 w-3 mr-1`}),`离线`]})})};return r?(0,H.jsx)(`div`,{className:`p-6`,children:`加载中...`}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(`div`,{className:`space-y-6`,children:[(0,H.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`实例管理`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`管理 NapGram 实例和 QQ Bot 配置`})]}),(0,H.jsxs)(G,{onClick:p,children:[(0,H.jsx)(it,{className:`h-4 w-4 mr-2`}),`添加实例`]})]}),(0,H.jsx)(`div`,{className:`grid gap-6 md:grid-cols-2 lg:grid-cols-3`,children:t.length===0?(0,H.jsx)(`div`,{className:`col-span-full text-center py-12 text-gray-500 dark:text-gray-400`,children:`暂无实例`}):t.map(e=>(0,H.jsxs)(Y,{className:`p-6`,children:[(0,H.jsxs)(`div`,{className:`flex items-start justify-between mb-4`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsxs)(`h3`,{className:`text-lg font-semibold text-gray-900 dark:text-white`,children:[`实例 #`,e.id]}),(0,H.jsxs)(`p`,{className:`text-sm text-gray-600 dark:text-gray-400 mt-1`,children:[`Owner: `,e.owner]})]}),g(e)]}),(0,H.jsxs)(`div`,{className:`space-y-3 text-sm`,children:[(0,H.jsxs)(`div`,{className:`flex justify-between`,children:[(0,H.jsx)(`span`,{className:`text-gray-600 dark:text-gray-400`,children:`工作模式:`}),(0,H.jsx)(`span`,{className:`font-medium text-gray-900 dark:text-white`,children:e.workMode||`未设置`})]}),(0,H.jsxs)(`div`,{className:`flex justify-between`,children:[(0,H.jsx)(`span`,{className:`text-gray-600 dark:text-gray-400`,children:`QQ Bot:`}),(0,H.jsx)(`span`,{className:`font-medium text-gray-900 dark:text-white`,children:e.qqBot?(0,H.jsxs)(`span`,{className:`flex items-center`,children:[e.qqBot.type===`napcat`?`NapCat`:`OICQ`,e.qqBot.uin&&(0,H.jsxs)(`span`,{className:`ml-1 text-xs text-gray-500`,children:[`(`,e.qqBot.uin,`)`]})]}):`未配置`})]}),(0,H.jsxs)(`div`,{className:`flex justify-between`,children:[(0,H.jsx)(`span`,{className:`text-gray-600 dark:text-gray-400`,children:`配对数量:`}),(0,H.jsx)(`span`,{className:`font-medium text-gray-900 dark:text-white`,children:e.pairCount})]}),e.qqBot?.wsUrl&&(0,H.jsx)(`div`,{className:`pt-2 border-t border-gray-200 dark:border-gray-700`,children:(0,H.jsxs)(`span`,{className:`text-xs text-gray-500 dark:text-gray-400`,children:[`WS: `,e.qqBot.wsUrl]})})]}),(0,H.jsxs)(`div`,{className:`flex gap-2 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700`,children:[(0,H.jsxs)(G,{variant:`outline`,size:`sm`,className:`flex-1`,onClick:()=>m(e),children:[(0,H.jsx)(We,{className:`h-4 w-4 mr-2`}),`编辑`]}),(0,H.jsx)(G,{variant:`outline`,size:`sm`,onClick:()=>f(e.id),className:`text-red-600 hover:text-red-700 hover:border-red-300 hover:bg-red-50 dark:hover:bg-red-900/20`,children:(0,H.jsx)(ge,{className:`h-4 w-4`})})]})]},e.id))})]}),(0,H.jsx)(pi,{open:a,onOpenChange:o,children:(0,H.jsxs)(gi,{children:[(0,H.jsx)(_i,{children:(0,H.jsx)(yi,{children:s?`编辑实例 #${s.id}`:`新建实例`})}),(0,H.jsxs)(`div`,{className:`grid gap-3`,children:[!s&&(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`Owner`}),(0,H.jsx)(W,{value:l.owner,onChange:e=>u({...l,owner:e.target.value}),placeholder:`用户 ID（数字）`})]}),(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`工作模式`}),(0,H.jsx)(W,{value:l.workMode,onChange:e=>u({...l,workMode:e.target.value}),placeholder:`可留空`})]}),(0,H.jsxs)(`div`,{className:`grid gap-2`,children:[(0,H.jsx)(J,{children:`QQ Bot ID（可选）`}),(0,H.jsx)(W,{value:l.qqBotId,onChange:e=>u({...l,qqBotId:e.target.value})})]}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(`input`,{id:`isSetup`,type:`checkbox`,checked:l.isSetup,onChange:e=>u({...l,isSetup:e.target.checked})}),(0,H.jsx)(J,{htmlFor:`isSetup`,children:`标记为已配置`})]})]}),(0,H.jsxs)(vi,{className:`pt-4`,children:[(0,H.jsx)(G,{variant:`outline`,onClick:()=>o(!1),children:`取消`}),(0,H.jsx)(G,{onClick:h,children:s?`保存修改`:`创建`})]})]})})]})}function ki({className:e,...t}){return(0,H.jsx)(at,{"data-slot":`switch`,className:V(`peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50`,e),...t,children:(0,H.jsx)(qe,{"data-slot":`switch-thumb`,className:V(`bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0 rtl:data-[state=checked]:-translate-x-[calc(100%-2px)]`)})})}function Ai(){let{token:e}=q(),[n]=he(),[r,i]=(0,P.useState)([]),[a,o]=(0,P.useState)(!0),[s,c]=(0,P.useState)(``),[l,u]=(0,P.useState)(1),[d,f]=(0,P.useState)(0),[p,m]=(0,P.useState)(`id`),[h,g]=(0,P.useState)(`desc`),[_,v]=(0,P.useState)(void 0),[y,b]=(0,P.useState)(void 0),[ee,x]=(0,P.useState)(!1),S=(0,P.useMemo)(()=>[{id:`id`,label:`ID`,enableSort:!0},{id:`time`,label:`时间`,enableSort:!0},{id:`qqRoomId`,label:`QQ Room`,enableSort:!0},{id:`tgChatId`,label:`TG Chat`,enableSort:!0},{id:`content`,label:`内容摘要`}],[]),C={id:!0,time:!0,qqRoomId:!0,tgChatId:!0,content:!0},[w,te]=(0,P.useState)(()=>{let e=localStorage.getItem(`msg-columns`);if(e)try{let t=JSON.parse(e),n=new Set(S.map(e=>e.id)),r=t.filter(e=>n.has(e.id)),i=S.filter(e=>!r.find(t=>t.id===e.id));return[...r,...i]}catch{}return S}),[T,E]=(0,P.useState)(()=>{let e=localStorage.getItem(`msg-columns-visible`);if(e)try{let t=JSON.parse(e);return{...C,...t}}catch{}return C});(0,P.useEffect)(()=>{let e=n.get(`from`),t=n.get(`to`);e&&v(parseInt(e)),t&&b(parseInt(t))},[]),(0,P.useEffect)(()=>{ne()},[e,l,p,h,_,y]);let ne=async()=>{o(!0);try{let t=new URLSearchParams({page:String(l),limit:`20`,sortBy:p,sortDir:h});s&&t.append(`search`,s),_&&t.append(`from`,String(_)),y&&t.append(`to`,String(y));let n=await fetch(`/api/admin/messages?${t.toString()}`,{headers:{Authorization:`Bearer ${e}`}});if(n.ok){let e=await n.json();i(e.items||[]),f(e.total||0)}}catch(e){console.error(`Failed to fetch messages:`,e)}finally{o(!1)}},re=()=>{u(1),ne()};(0,P.useEffect)(()=>{localStorage.setItem(`msg-columns`,JSON.stringify(w))},[w]),(0,P.useEffect)(()=>{localStorage.setItem(`msg-columns-visible`,JSON.stringify(T))},[T]);let D=w.filter(e=>T[e.id]),O=e=>{if(!e){v(void 0),b(void 0),u(1);return}let t=Math.floor(Date.now()/1e3);v(t-e*3600),b(t),u(1)},k=()=>{let e=new Date;e.setHours(0,0,0,0),v(Math.floor(e.getTime()/1e3)),b(Math.floor(Date.now()/1e3)),u(1)},A=e=>{p===e?g(h===`asc`?`desc`:`asc`):(m(e),g(`desc`)),u(1)},[ie,ae]=(0,P.useState)(null),oe=e=>ae(e),se=e=>{if(!ie||ie===e)return;let t=w.findIndex(e=>e.id===ie),n=w.findIndex(t=>t.id===e);if(t===-1||n===-1)return;let r=[...w],[i]=r.splice(t,1);r.splice(n,0,i),te(r)},j=()=>ae(null);return a?(0,H.jsx)(`div`,{className:`p-6`,children:`加载中...`}):(0,H.jsxs)(`div`,{className:`h-full flex flex-col space-y-6 min-h-0`,children:[(0,H.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`消息记录`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`查看所有转发的消息历史`})]}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsxs)(`div`,{className:`flex rounded-md border bg-muted/40 p-1`,children:[(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>O(void 0),children:`全部`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>O(1),children:`1小时`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>O(12),children:`12小时`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>k(),children:`今天`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>O(24),children:`1天`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>O(168),children:`7天`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>O(720),children:`30天`})]}),(0,H.jsxs)(G,{variant:`outline`,size:`sm`,onClick:()=>x(!0),children:[(0,H.jsx)(t,{className:`h-4 w-4 mr-2`}),`列配置`]})]})]}),(0,H.jsxs)(Y,{className:`flex flex-col h-full min-h-0`,children:[(0,H.jsx)(X,{children:(0,H.jsxs)(Z,{className:`flex items-center justify-between`,children:[(0,H.jsxs)(`span`,{className:`flex items-center`,children:[(0,H.jsx)(Qe,{className:`h-5 w-5 mr-2`}),`消息列表`]}),(0,H.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[(0,H.jsx)(W,{placeholder:`搜索消息内容或关键词...`,value:s,onChange:e=>c(e.target.value),className:`w-64`}),(0,H.jsx)(G,{onClick:re,size:`sm`,children:(0,H.jsx)(ot,{className:`h-4 w-4`})})]})]})}),(0,H.jsx)(Q,{className:`flex-1 min-h-0`,children:r.length===0?(0,H.jsx)(`div`,{className:`text-center text-gray-500 py-12`,children:`暂无消息记录`}):(0,H.jsxs)(`div`,{className:`h-full flex flex-col min-h-0`,children:[(0,H.jsx)(`div`,{className:`flex-1 min-h-0 overflow-auto rounded-md border`,children:(0,H.jsxs)(qn,{children:[(0,H.jsx)(Jn,{children:(0,H.jsx)(Xn,{children:D.map(e=>(0,H.jsx)(Zn,{className:V(`cursor-pointer select-none`,!e.enableSort&&`cursor-default`),onClick:()=>e.enableSort&&A(e.id),children:(0,H.jsxs)(`span`,{className:`flex items-center gap-1`,children:[e.label,p===e.id&&(0,H.jsx)(`span`,{className:`text-xs text-muted-foreground`,children:h===`asc`?`↑`:`↓`})]})},e.id))})}),(0,H.jsx)(Yn,{children:r.map(e=>(0,H.jsx)(Xn,{children:D.map(t=>{switch(t.id){case`id`:return(0,H.jsxs)(U,{className:`font-medium`,children:[`#`,e.id]},t.id);case`time`:return(0,H.jsx)(U,{className:`text-sm text-muted-foreground`,children:new Date(e.time*1e3).toLocaleString(`zh-CN`)},t.id);case`qqRoomId`:return(0,H.jsx)(U,{className:`text-sm text-muted-foreground`,children:e.qqRoomId},t.id);case`tgChatId`:return(0,H.jsx)(U,{className:`text-sm text-muted-foreground`,children:e.tgChatId},t.id);case`content`:default:return(0,H.jsx)(U,{className:`max-w-md`,children:(0,H.jsx)(`p`,{className:V(`truncate text-sm`,!e.brief&&!e.tgMessageText&&`text-muted-foreground`),children:e.brief||e.tgMessageText||`无内容`})},t.id)}})},e.id))})]})}),(0,H.jsxs)(`div`,{className:`flex items-center justify-between pt-4`,children:[(0,H.jsxs)(`p`,{className:`text-sm text-gray-600`,children:[`共 `,d,` 条记录，第 `,l,` 页`]}),(0,H.jsxs)(`div`,{className:`flex space-x-2`,children:[(0,H.jsx)(G,{variant:`outline`,size:`sm`,onClick:()=>u(e=>Math.max(1,e-1)),disabled:l===1,children:`上一页`}),(0,H.jsx)(G,{variant:`outline`,size:`sm`,onClick:()=>u(e=>e+1),disabled:r.length<20,children:`下一页`})]})]})]})})]}),(0,H.jsx)(pi,{open:ee,onOpenChange:x,children:(0,H.jsxs)(gi,{children:[(0,H.jsx)(_i,{children:(0,H.jsx)(yi,{children:`列配置与排序`})}),(0,H.jsxs)(`div`,{className:`grid gap-4`,children:[(0,H.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`拖动调整列顺序，切换开关控制显示。`}),(0,H.jsx)(`div`,{className:`space-y-2`,children:w.map(e=>(0,H.jsxs)(`div`,{className:`flex items-center justify-between rounded-md border px-3 py-2`,draggable:!0,onDragStart:()=>oe(e.id),onDragOver:t=>{t.preventDefault(),se(e.id)},onDragEnd:j,children:[(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(Te,{className:`h-4 w-4 text-muted-foreground`}),(0,H.jsx)(`span`,{children:e.label})]}),(0,H.jsx)(ki,{checked:T[e.id],onCheckedChange:t=>E({...T,[e.id]:t})})]},e.id))})]}),(0,H.jsxs)(vi,{children:[(0,H.jsx)(G,{variant:`outline`,onClick:()=>{te(S),E(C)},children:`重置`}),(0,H.jsx)(G,{onClick:()=>x(!1),children:`完成`})]})]})})]})}function ji(){let{token:e}=q(),[t,n]=(0,P.useState)(null),[r,i]=(0,P.useState)([]),[a,o]=(0,P.useState)(!0),s=ee();(0,P.useEffect)(()=>{c()},[e]);let c=async()=>{try{let t=await fetch(`/api/admin/statistics/overview`,{headers:{Authorization:`Bearer ${e}`}});t.ok&&n((await t.json()).data);let r=await fetch(`/api/admin/statistics/messages/trend?days=30`,{headers:{Authorization:`Bearer ${e}`}});r.ok&&i((await r.json()).data||[])}catch(e){console.error(`Failed to fetch statistics:`,e)}finally{o(!1)}};return a?(0,H.jsx)(`div`,{className:`p-6`,children:`加载中...`}):(0,H.jsxs)(`div`,{className:`space-y-6`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`统计分析`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`系统运行数据和趋势分析`})]}),(0,H.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2 lg:grid-cols-4`,children:[(0,H.jsxs)(Y,{className:`cursor-pointer hover:shadow-md transition`,onClick:()=>s(`/admin/pairs`),children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`活跃配对`}),(0,H.jsx)(x,{className:`h-4 w-4 text-blue-600`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsx)(`div`,{className:`text-2xl font-bold`,children:t?.pairCount||0}),(0,H.jsx)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:`QQ-TG 配对数量`})]})]}),(0,H.jsxs)(Y,{className:`cursor-pointer hover:shadow-md transition`,onClick:()=>s(`/admin/instances`),children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`运行实例`}),(0,H.jsx)(He,{className:`h-4 w-4 text-green-600`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsx)(`div`,{className:`text-2xl font-bold`,children:t?.instanceCount||0}),(0,H.jsx)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:`活跃的 Bot 实例`})]})]}),(0,H.jsxs)(Y,{className:`cursor-pointer hover:shadow-md transition`,onClick:()=>s(`/admin/messages`),children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`总消息数`}),(0,H.jsx)(D,{className:`h-4 w-4 text-purple-600`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsx)(`div`,{className:`text-2xl font-bold`,children:t?.messageCount?.toLocaleString()||0}),(0,H.jsx)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:`累计转发消息`})]})]}),(0,H.jsxs)(Y,{className:`cursor-pointer hover:shadow-md transition`,onClick:()=>{let e=new Date;e.setHours(0,0,0,0),s(`/admin/messages?from=${Math.floor(e.getTime()/1e3)}`)},children:[(0,H.jsxs)(X,{className:`flex flex-row items-center justify-between pb-2`,children:[(0,H.jsx)(Z,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`今日消息`}),(0,H.jsx)(b,{className:`h-4 w-4 text-orange-600`})]}),(0,H.jsxs)(Q,{children:[(0,H.jsx)(`div`,{className:`text-2xl font-bold`,children:t?.todayMessageCount||0}),(0,H.jsx)(`p`,{className:`text-xs text-gray-600 dark:text-gray-400 mt-1`,children:`今天转发的消息`})]})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsxs)(Z,{className:`flex items-center`,children:[(0,H.jsx)(b,{className:`h-5 w-5 mr-2`}),`消息趋势（近30天）`]})}),(0,H.jsx)(Q,{children:r.length>0?(0,H.jsx)(se,{width:`100%`,height:300,children:(0,H.jsxs)(Ne,{data:r,children:[(0,H.jsx)(we,{strokeDasharray:`3 3`,className:`stroke-gray-200 dark:stroke-gray-700`}),(0,H.jsx)(lt,{dataKey:`date`,tickFormatter:e=>new Date(e).toLocaleDateString(`zh-CN`,{month:`short`,day:`numeric`})}),(0,H.jsx)(be,{}),(0,H.jsx)(pt,{labelFormatter:e=>new Date(e).toLocaleDateString(`zh-CN`),formatter:e=>[`${e} 条消息`,`数量`]}),(0,H.jsx)(ht,{type:`monotone`,dataKey:`count`,stroke:`#3b82f6`,strokeWidth:2,dot:{fill:`#3b82f6`,r:4},activeDot:{r:6}})]})}):(0,H.jsx)(`div`,{className:`text-center text-gray-500 py-12`,children:`暂无数据`})})]})]})}function Mi(){let{token:e}=q(),[t,n]=(0,P.useState)([]),[r,i]=(0,P.useState)(!0),[a,o]=(0,P.useState)(``),[s,c]=(0,P.useState)(`all`),[l,u]=(0,P.useState)(`all`),[f,p]=(0,P.useState)(void 0),[m,h]=(0,P.useState)(void 0),[g,_]=(0,P.useState)(!0),[v,y]=(0,P.useState)(18),[b,ee]=(0,P.useState)({}),x=(0,P.useRef)(null),S=(0,P.useCallback)(async t=>{t?.silent||i(!0);try{let t=new URLSearchParams;t.append(`limit`,`800`),s!==`all`&&t.append(`level`,s);let r=await fetch(`/api/admin/logs?${t}`,{headers:{Authorization:`Bearer ${e}`}});r.ok&&n((await r.json()).data||[])}catch(e){console.error(`Failed to fetch logs:`,e)}finally{i(!1)}},[s,e]);(0,P.useEffect)(()=>{S()},[S]),(0,P.useEffect)(()=>{if(!g)return;S({silent:!0});let e=setInterval(()=>S({silent:!0}),8e3);return()=>clearInterval(e)},[g,S]);let C=e=>{let t=Date.parse(e);return Number.isNaN(t)?void 0:Math.floor(t/1e3)},w=e=>{if(!e){p(void 0),h(void 0);return}let t=Math.floor(Date.now()/1e3);p(t-e*3600),h(t)},te=()=>{let e=new Date;e.setHours(0,0,0,0),p(Math.floor(e.getTime()/1e3)),h(Math.floor(Date.now()/1e3))},T=(0,P.useMemo)(()=>t.filter(e=>{if(s!==`all`&&e.level.toLowerCase()!==s||l!==`all`&&e.module!==l)return!1;let t=new Date(e.time).getTime();return f&&t<f*1e3||m&&t>m*1e3?!1:e.message?.toLowerCase().includes(a.toLowerCase())||e.module?.toLowerCase().includes(a.toLowerCase())}),[t,s,l,f,m,a]),E=(0,P.useMemo)(()=>[...T].sort((e,t)=>new Date(e.time).getTime()-new Date(t.time).getTime()),[T]),ne=(0,P.useMemo)(()=>{let e=new Set;return t.forEach(t=>t.module&&e.add(t.module)),Array.from(e)},[t]),re=e=>{let t=e.toUpperCase();return t.includes(`ERROR`)||t===`FATAL`?`text-red-400`:t.includes(`WARN`)?`text-amber-300`:t.includes(`DEBUG`)||t.includes(`TRACE`)?`text-cyan-300`:`text-emerald-300`},D=(e,t)=>`${e.time}-${e.level}-${e.module??`system`}-${t}`,O=e=>{let t=[e.indexOf(`{`),e.indexOf(`[`)].filter(e=>e>=0);if(t.length===0)return null;let n=Math.min(...t),r=e.slice(n),i=Math.max(r.lastIndexOf(`}`),r.lastIndexOf(`]`)),a=i>0?r.slice(0,i+1).trim():r.trim();try{let t=JSON.parse(a);return{prefix:e.slice(0,n).trim(),json:t}}catch{return null}},k=e=>{let t=(typeof e==`string`?e:JSON.stringify(e)).replace(/\s+/g,` `);return t.length<=200?t:`${t.slice(0,200)}…`},A=(0,P.useMemo)(()=>f?new Date(f*1e3).toISOString().slice(0,16):``,[f]),ie=(0,P.useMemo)(()=>m?new Date(m*1e3).toISOString().slice(0,16):``,[m]),ae=Math.max(2,Math.floor(v/4));return(0,P.useEffect)(()=>{x.current&&(x.current.scrollTop=x.current.scrollHeight)},[E,v]),r?(0,H.jsx)(`div`,{className:`p-6`,children:`加载中...`}):(0,H.jsxs)(`div`,{className:`h-full flex flex-col space-y-6 min-h-0`,children:[(0,H.jsxs)(`div`,{className:`flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`系统日志`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`实时查看系统运行日志`})]}),(0,H.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,H.jsxs)(`div`,{className:`flex rounded-md border bg-muted/40 p-1`,children:[(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>w(void 0),children:`全部`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>w(1),children:`1小时`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>w(12),children:`12小时`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:te,children:`今日`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>w(24),children:`1天`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>w(168),children:`7天`}),(0,H.jsx)(G,{variant:`ghost`,size:`sm`,onClick:()=>w(720),children:`30天`})]}),(0,H.jsxs)(G,{variant:`outline`,size:`sm`,onClick:()=>S(),children:[(0,H.jsx)(Re,{className:`h-4 w-4 mr-2`}),` 刷新`]}),(0,H.jsxs)(G,{variant:`outline`,size:`sm`,onClick:()=>_(e=>!e),children:[g?(0,H.jsx)(ct,{className:`h-4 w-4 mr-2`}):(0,H.jsx)(De,{className:`h-4 w-4 mr-2`}),g?`暂停`:`继续`]}),(0,H.jsxs)(G,{variant:`outline`,size:`sm`,onClick:()=>{let e=new Blob([JSON.stringify(T,null,2)],{type:`application/json`}),t=URL.createObjectURL(e),n=document.createElement(`a`);n.href=t,n.download=`logs-${Date.now()}.json`,n.click(),URL.revokeObjectURL(t)},children:[(0,H.jsx)(j,{className:`h-4 w-4 mr-2`}),`导出`]})]})]}),(0,H.jsxs)(Y,{className:`flex flex-col h-full`,children:[(0,H.jsxs)(X,{className:`space-y-4`,children:[(0,H.jsxs)(Z,{className:`flex items-center gap-2`,children:[(0,H.jsx)(mt,{className:`h-5 w-5`}),`日志列表`]}),(0,H.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2 lg:grid-cols-3`,children:[(0,H.jsx)(W,{placeholder:`搜索日志或模块...`,value:a,onChange:e=>o(e.target.value)}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(J,{className:`text-sm`,children:`模块`}),(0,H.jsxs)(`select`,{className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm`,value:l,onChange:e=>u(e.target.value),children:[(0,H.jsx)(`option`,{value:`all`,children:`全部模块`}),ne.map(e=>(0,H.jsx)(`option`,{value:e,children:e},e))]})]}),(0,H.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,H.jsx)(J,{className:`text-sm`,children:`级别`}),(0,H.jsx)(`div`,{className:`flex flex-wrap gap-2`,children:[{label:`全部`,value:`all`},{label:`信息`,value:`info`},{label:`警告`,value:`warn`},{label:`错误`,value:`error`},{label:`调试`,value:`debug`},{label:`追踪`,value:`trace`}].map(e=>(0,H.jsx)(G,{size:`sm`,variant:s===e.value?`default`:`outline`,onClick:()=>c(e.value),children:e.label},e.value))})]}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(J,{className:`text-sm`,children:`开始`}),(0,H.jsx)(W,{type:`datetime-local`,value:A,onChange:e=>p(C(e.target.value))})]}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(J,{className:`text-sm`,children:`结束`}),(0,H.jsx)(W,{type:`datetime-local`,value:ie,onChange:e=>h(C(e.target.value))})]}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,H.jsx)(J,{className:`text-sm`,children:`自动刷新`}),(0,H.jsx)(ki,{checked:g,onCheckedChange:_}),(0,H.jsxs)(`div`,{className:`flex items-center gap-2 ml-auto`,children:[(0,H.jsxs)(J,{className:`text-sm whitespace-nowrap`,children:[`行高: `,v,`px`]}),(0,H.jsx)(`input`,{type:`range`,min:14,max:28,step:2,value:v,onChange:e=>y(parseInt(e.target.value)),className:`w-36`})]})]})]})]}),(0,H.jsx)(Q,{className:`space-y-3 flex-1 min-h-0 flex flex-col`,children:(0,H.jsxs)(`div`,{className:`rounded-lg border bg-white text-neutral-900 shadow overflow-hidden dark:border-neutral-800 dark:bg-neutral-950 dark:text-neutral-100 flex-1 min-h-0`,children:[(0,H.jsxs)(`div`,{className:`grid grid-cols-[170px_90px_180px_1fr] border-b border-neutral-200 bg-neutral-100 px-3 py-2 text-xs uppercase tracking-wide text-neutral-500 dark:border-neutral-900 dark:bg-neutral-900 dark:text-neutral-400`,children:[(0,H.jsx)(`span`,{children:`时间`}),(0,H.jsx)(`span`,{children:`级别`}),(0,H.jsx)(`span`,{children:`模块`}),(0,H.jsx)(`span`,{children:`内容`})]}),(0,H.jsx)(`div`,{ref:x,className:`h-full max-h-full overflow-auto font-mono text-sm`,children:T.length===0?(0,H.jsx)(`div`,{className:`flex items-center justify-center py-12 text-neutral-400`,children:`暂无日志`}):E.map((e,t)=>{let n=D(e,t),r=O(e.message),i=!!b[n],a=r?JSON.stringify(r.json,null,2):``;return(0,H.jsxs)(`div`,{className:`grid grid-cols-[170px_90px_180px_1fr] px-3 border-b border-neutral-200 dark:border-neutral-900 ${t%2==0?`bg-neutral-50 dark:bg-neutral-900/30`:`bg-white dark:bg-neutral-900/10`}`,style:{lineHeight:`${v}px`,paddingTop:`${ae}px`,paddingBottom:`${ae}px`},children:[(0,H.jsx)(`div`,{className:`text-emerald-700 dark:text-emerald-300`,children:new Date(e.time).toLocaleString(`zh-CN`)}),(0,H.jsx)(`div`,{className:`font-semibold ${re(e.level)}`,children:e.level.toUpperCase()}),(0,H.jsx)(`div`,{className:`text-blue-600 dark:text-blue-300 truncate`,title:e.module||`System`,children:e.module||`System`}),(0,H.jsx)(`div`,{className:`overflow-hidden text-neutral-900 dark:text-neutral-100`,children:r?(0,H.jsxs)(`div`,{className:`space-y-1`,children:[(0,H.jsxs)(`button`,{className:`flex items-center gap-1 text-xs text-blue-300 hover:text-blue-200`,onClick:()=>ee(e=>({...e,[n]:!i})),children:[i?(0,H.jsx)(d,{className:`h-4 w-4`}):(0,H.jsx)(ce,{className:`h-4 w-4`}),i?`折叠 JSON`:`展开 JSON`]}),i?(0,H.jsxs)(H.Fragment,{children:[r.prefix&&(0,H.jsx)(`div`,{className:`text-neutral-300 text-xs whitespace-pre-wrap break-words mb-1`,children:r.prefix}),(0,H.jsx)(`pre`,{className:`rounded-md border border-neutral-300 bg-neutral-100 px-3 py-2 text-xs text-neutral-900 whitespace-pre-wrap dark:border-neutral-800 dark:bg-neutral-900/60 dark:text-neutral-50`,children:a})]}):(0,H.jsxs)(`div`,{className:`truncate whitespace-nowrap text-neutral-700 dark:text-neutral-200`,children:[r.prefix?`${r.prefix} `:``,k(r.json)]})]}):(0,H.jsx)(`span`,{className:`whitespace-pre-wrap break-words`,children:e.message})})]},n)})})]})})]})]})}function Ni(){let{token:e}=q(),[t,n]=(0,P.useState)({systemName:`NapGram`,enableAutoBackup:!0,enableNotifications:!0,qqToTgForward:!0,tgToQqForward:!0,showNickname:!0,autoRecallMessage:!1,messageCacheHours:24,maxConcurrentConnections:10,enableMessageCompression:!0,enableIpWhitelist:!1,enableOperationLog:!0}),[r,i]=(0,P.useState)(!0),[a,o]=(0,P.useState)(!1),[s,c]=(0,P.useState)(null);(0,P.useEffect)(()=>{l()},[e]);let l=async()=>{try{let r=await fetch(`/api/admin/settings`,{headers:{Authorization:`Bearer ${e}`}});r.ok&&n((await r.json()).data||t)}catch(e){console.error(`Failed to fetch settings:`,e)}finally{i(!1)}};return r?(0,H.jsx)(`div`,{className:`p-6`,children:`加载中...`}):(0,H.jsxs)(`div`,{className:`space-y-6`,children:[(0,H.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`系统设置`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`配置系统参数和行为`})]}),(0,H.jsxs)(`div`,{className:`flex space-x-2`,children:[(0,H.jsxs)(G,{variant:`outline`,onClick:()=>{l(),c({type:`success`,text:`已重置为服务器配置`})},children:[(0,H.jsx)(nt,{className:`h-4 w-4 mr-2`}),`重置`]}),(0,H.jsxs)(G,{onClick:async()=>{o(!0),c(null);try{let n=await fetch(`/api/admin/settings`,{method:`PUT`,headers:{Authorization:`Bearer ${e}`,"Content-Type":`application/json`},body:JSON.stringify(t)});n.ok?c({type:`success`,text:`设置已保存`}):c({type:`error`,text:(await n.json().catch(()=>null))?.error||`保存失败，请重试`})}catch{c({type:`error`,text:`保存失败，请检查网络连接`})}finally{o(!1)}},disabled:a,children:[(0,H.jsx)(Je,{className:`h-4 w-4 mr-2`}),a?`保存中...`:`保存设置`]})]})]}),s&&(0,H.jsx)(or,{variant:s.type===`error`?`destructive`:`default`,children:(0,H.jsx)(sr,{children:s.text})}),(0,H.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:[(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsxs)(Z,{className:`flex items-center`,children:[(0,H.jsx)(A,{className:`h-5 w-5 mr-2`}),`基本设置`]})}),(0,H.jsxs)(Q,{className:`space-y-4`,children:[(0,H.jsxs)(`div`,{className:`space-y-2`,children:[(0,H.jsx)(J,{htmlFor:`systemName`,children:`系统名称`}),(0,H.jsx)(W,{id:`systemName`,value:t.systemName,onChange:e=>n({...t,systemName:e.target.value})})]}),(0,H.jsxs)(`div`,{className:`space-y-2`,children:[(0,H.jsx)(J,{htmlFor:`messageCacheHours`,children:`消息缓存时长（小时）`}),(0,H.jsx)(W,{id:`messageCacheHours`,type:`number`,value:t.messageCacheHours,onChange:e=>n({...t,messageCacheHours:parseInt(e.target.value)||0})})]}),(0,H.jsxs)(`div`,{className:`space-y-2`,children:[(0,H.jsx)(J,{htmlFor:`maxConcurrentConnections`,children:`最大并发连接`}),(0,H.jsx)(W,{id:`maxConcurrentConnections`,type:`number`,value:t.maxConcurrentConnections,onChange:e=>n({...t,maxConcurrentConnections:parseInt(e.target.value)||1})})]})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsx)(Z,{children:`转发与通知`})}),(0,H.jsxs)(Q,{className:`space-y-4`,children:[(0,H.jsx)($,{label:`启用 QQ → TG 转发`,checked:t.qqToTgForward,onChange:e=>n({...t,qqToTgForward:e})}),(0,H.jsx)($,{label:`启用 TG → QQ 转发`,checked:t.tgToQqForward,onChange:e=>n({...t,tgToQqForward:e})}),(0,H.jsx)($,{label:`显示昵称`,checked:t.showNickname,onChange:e=>n({...t,showNickname:e})}),(0,H.jsx)($,{label:`自动撤回`,checked:t.autoRecallMessage,onChange:e=>n({...t,autoRecallMessage:e})}),(0,H.jsx)($,{label:`启用系统通知`,checked:t.enableNotifications,onChange:e=>n({...t,enableNotifications:e})})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsx)(Z,{children:`系统功能`})}),(0,H.jsxs)(Q,{className:`space-y-4`,children:[(0,H.jsx)($,{label:`启用自动备份`,checked:t.enableAutoBackup,onChange:e=>n({...t,enableAutoBackup:e})}),(0,H.jsx)($,{label:`启用消息压缩`,checked:t.enableMessageCompression,onChange:e=>n({...t,enableMessageCompression:e})}),(0,H.jsx)($,{label:`开启白名单`,checked:t.enableIpWhitelist,onChange:e=>n({...t,enableIpWhitelist:e})}),(0,H.jsx)($,{label:`记录操作日志`,checked:t.enableOperationLog,onChange:e=>n({...t,enableOperationLog:e})})]})]})]})]})}function $({label:e,checked:t,onChange:n}){return(0,H.jsxs)(`div`,{className:`flex items-center justify-between py-2 border-b border-border/50 last:border-b-0`,children:[(0,H.jsx)(`span`,{className:`text-sm text-muted-foreground`,children:e}),(0,H.jsx)(ki,{checked:t,onCheckedChange:n})]})}function Pi(){let{user:e}=q();return(0,H.jsxs)(`div`,{className:`space-y-6`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900 dark:text-white`,children:`个人资料`}),(0,H.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mt-2`,children:`查看和管理您的账户信息`})]}),(0,H.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:[(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsxs)(Z,{className:`flex items-center`,children:[(0,H.jsx)($e,{className:`h-5 w-5 mr-2`}),`基本信息`]})}),(0,H.jsxs)(Q,{className:`space-y-4`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`label`,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`用户名`}),(0,H.jsx)(`p`,{className:`mt-1 text-lg font-semibold`,children:e?.username||`管理员`})]}),(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`label`,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`显示名称`}),(0,H.jsx)(`p`,{className:`mt-1 text-lg font-semibold`,children:e?.displayName||e?.username||`管理员`})]})]})]}),(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsxs)(Z,{className:`flex items-center`,children:[(0,H.jsx)(Ke,{className:`h-5 w-5 mr-2`}),`联系信息`]})}),(0,H.jsx)(Q,{className:`space-y-4`,children:(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`label`,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`邮箱地址`}),(0,H.jsx)(`p`,{className:`mt-1 text-lg`,children:e?.email||`未设置`})]})})]}),(0,H.jsxs)(Y,{children:[(0,H.jsx)(X,{children:(0,H.jsxs)(Z,{className:`flex items-center`,children:[(0,H.jsx)(ve,{className:`h-5 w-5 mr-2`}),`权限信息`]})}),(0,H.jsxs)(Q,{className:`space-y-4`,children:[(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`label`,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`角色`}),(0,H.jsx)(`p`,{className:`mt-1 text-lg`,children:(0,H.jsx)(`span`,{className:`px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full text-sm font-medium`,children:`管理员`})})]}),(0,H.jsxs)(`div`,{children:[(0,H.jsx)(`label`,{className:`text-sm font-medium text-gray-600 dark:text-gray-400`,children:`权限范围`}),(0,H.jsx)(`p`,{className:`mt-1 text-sm text-gray-600 dark:text-gray-400`,children:`完全访问所有管理功能`})]})]})]})]})]})}function Fi(){let{uuid:e}=_e();return e?(0,H.jsx)(Wn,{uuid:e}):(0,H.jsx)(`div`,{children:`No UUID provided`})}function Ii(){let[e]=he(),t=e.get(`tgWebAppStartParam`)||e.get(`uuid`)||e.get(`id`);return t?(0,H.jsx)(Wn,{uuid:t}):(0,H.jsx)(`div`,{className:`p-4 text-red-500`,children:`Missing uuid`})}function Li(){return(0,H.jsx)(nr,{children:(0,H.jsx)(de,{children:(0,H.jsxs)(S,{children:[(0,H.jsx)(h,{path:`/login`,element:(0,H.jsx)(cr,{})}),(0,H.jsx)(h,{path:`/chatRecord`,element:(0,H.jsx)(Ii,{})}),(0,H.jsx)(h,{path:`/merged/:uuid`,element:(0,H.jsx)(Fi,{})}),(0,H.jsx)(h,{path:`/records`,element:(0,H.jsx)($n,{})}),(0,H.jsxs)(h,{path:`/admin`,element:(0,H.jsx)(rr,{children:(0,H.jsx)(di,{})}),children:[(0,H.jsx)(h,{index:!0,element:(0,H.jsx)(fi,{})}),(0,H.jsx)(h,{path:`pairs`,element:(0,H.jsx)(Di,{})}),(0,H.jsx)(h,{path:`instances`,element:(0,H.jsx)(Oi,{})}),(0,H.jsx)(h,{path:`messages`,element:(0,H.jsx)(Ai,{})}),(0,H.jsx)(h,{path:`statistics`,element:(0,H.jsx)(ji,{})}),(0,H.jsx)(h,{path:`logs`,element:(0,H.jsx)(Mi,{})}),(0,H.jsx)(h,{path:`settings`,element:(0,H.jsx)(Ni,{})}),(0,H.jsx)(h,{path:`profile`,element:(0,H.jsx)(Pi,{})})]}),(0,H.jsx)(h,{path:`/`,element:(0,H.jsx)(N,{to:`/admin`,replace:!0})})]})})})}var Ri=Li;(0,bt.createRoot)(document.getElementById(`root`)).render((0,H.jsx)(P.StrictMode,{children:(0,H.jsx)(ti,{defaultTheme:`system`,children:(0,H.jsx)(Ri,{})})}));